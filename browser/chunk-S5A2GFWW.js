import{e as Vi}from"./chunk-EAV54HNS.js";import{a as G,b as ji,c as U,d as Zi}from"./chunk-AEPMFU2B.js";import{c as M,d as z,n as T,o as Z,p as Ni,s as $i,t as F,u as Bi}from"./chunk-HD4ISDNJ.js";import{b as he}from"./chunk-3LEWPSQC.js";import{b as Li}from"./chunk-25DFGJNI.js";import{a as _e}from"./chunk-WMO7HUQ5.js";import{c as xt,d as J,e as De,f as ze,j as Re,k as kt,l as Oe,m as At,n as Ee,o as Dt,p as zt,q as Rt,r as Oi,s as Te,u as Ei,w as Fi}from"./chunk-DL7W725W.js";import{$ as hi,A as mi,D as gi,L as ke,N as Ae,O as zi,P as Ri,Q as ui,V as Ot,c as wt,f as xi,h as W,i as ki,ia as Ti,k as Ai,ka as N,m as Mt,ma as Pi,n as Di,p as ue,y as pi}from"./chunk-I22IGBHY.js";import{Aa as ri,Ab as Si,Bb as O,C as V,Cb as E,D as bi,Db as o,Eb as a,Fb as A,Ha as ai,Ia as u,Ja as h,Jb as b,Jc as ci,L as x,Mb as m,Nb as d,Ob as oi,P as re,Pb as si,Qa as R,Qb as Ue,Ra as ge,Sb as wi,Tb as It,Ua as bt,Ub as St,V as Q,Vb as ye,Wb as p,Xb as ee,Ya as Ii,Yb as L,Zb as li,a as S,aa as B,b as w,db as s,eb as ae,fa as j,fc as Mi,ga as ni,gc as xe,hc as oe,ib as ce,ic as He,jc as be,l as ie,lb as f,na as ne,o as yi,oa as pe,p as yt,pc as I,qb as y,qc as D,rc as di,sa as Me,sb as c,sc as We,ta as g,w as _,ya as k,yb as C,za as me,zb as H}from"./chunk-7JXHIXKM.js";var Cn=["*"],Qe=class{_clearListeners(){for(let e of this._listeners)e.remove();this._listeners=[]}constructor(e){this._ngZone=e,this._pending=[],this._listeners=[],this._targetStream=new yt(void 0)}getLazyEmitter(e){return this._targetStream.pipe(j(t=>{let n=new ie(r=>{if(!t){this._pending.push({observable:n,observer:r});return}let l=t.addListener(e,v=>{this._ngZone.run(()=>r.next(v))});if(!l){r.complete();return}return this._listeners.push(l),()=>l.remove()});return n}))}setTarget(e){let t=this._targetStream.value;e!==t&&(t&&(this._clearListeners(),this._pending=[]),this._targetStream.next(e),this._pending.forEach(n=>n.observable.subscribe(n.observer)),this._pending=[])}destroy(){this._clearListeners(),this._pending=[],this._targetStream.complete()}},qe={center:{lat:37.421995,lng:-122.084092},zoom:17,mapTypeId:"roadmap"},Gi="500px",Ui="500px",Et=(()=>{let e=class e{set center(n){this._center=n}set zoom(n){this._zoom=n}set options(n){this._options=n||qe}constructor(n,r,l){if(this._elementRef=n,this._ngZone=r,this._eventManager=new Qe(g(ge)),this.height=Gi,this.width=Ui,this._options=qe,this.mapInitialized=new R,this.authFailure=new R,this.boundsChanged=this._eventManager.getLazyEmitter("bounds_changed"),this.centerChanged=this._eventManager.getLazyEmitter("center_changed"),this.mapClick=this._eventManager.getLazyEmitter("click"),this.mapDblclick=this._eventManager.getLazyEmitter("dblclick"),this.mapDrag=this._eventManager.getLazyEmitter("drag"),this.mapDragend=this._eventManager.getLazyEmitter("dragend"),this.mapDragstart=this._eventManager.getLazyEmitter("dragstart"),this.headingChanged=this._eventManager.getLazyEmitter("heading_changed"),this.idle=this._eventManager.getLazyEmitter("idle"),this.maptypeidChanged=this._eventManager.getLazyEmitter("maptypeid_changed"),this.mapMousemove=this._eventManager.getLazyEmitter("mousemove"),this.mapMouseout=this._eventManager.getLazyEmitter("mouseout"),this.mapMouseover=this._eventManager.getLazyEmitter("mouseover"),this.projectionChanged=this._eventManager.getLazyEmitter("projection_changed"),this.mapRightclick=this._eventManager.getLazyEmitter("rightclick"),this.tilesloaded=this._eventManager.getLazyEmitter("tilesloaded"),this.tiltChanged=this._eventManager.getLazyEmitter("tilt_changed"),this.zoomChanged=this._eventManager.getLazyEmitter("zoom_changed"),this._isBrowser=Di(l),this._isBrowser){let v=window;v.google,this._existingAuthFailureCallback=v.gm_authFailure,v.gm_authFailure=()=>{this._existingAuthFailureCallback&&this._existingAuthFailureCallback(),this.authFailure.emit()}}}ngOnChanges(n){(n.height||n.width)&&this._setSize();let r=this.googleMap;r&&(n.options&&r.setOptions(this._combineOptions()),n.center&&this._center&&r.setCenter(this._center),n.zoom&&this._zoom!=null&&r.setZoom(this._zoom),n.mapTypeId&&this.mapTypeId&&r.setMapTypeId(this.mapTypeId))}ngOnInit(){this._isBrowser&&(this._mapEl=this._elementRef.nativeElement.querySelector(".map-container"),this._setSize(),google.maps.Map?this._initialize(google.maps.Map):this._ngZone.runOutsideAngular(()=>{google.maps.importLibrary("maps").then(n=>this._initialize(n.Map))}))}_initialize(n){this._ngZone.runOutsideAngular(()=>{this.googleMap=new n(this._mapEl,this._combineOptions()),this._eventManager.setTarget(this.googleMap),this.mapInitialized.emit(this.googleMap)})}ngOnDestroy(){if(this.mapInitialized.complete(),this._eventManager.destroy(),this._isBrowser){let n=window;n.gm_authFailure=this._existingAuthFailureCallback}}fitBounds(n,r){this._assertInitialized(),this.googleMap.fitBounds(n,r)}panBy(n,r){this._assertInitialized(),this.googleMap.panBy(n,r)}panTo(n){this._assertInitialized(),this.googleMap.panTo(n)}panToBounds(n,r){this._assertInitialized(),this.googleMap.panToBounds(n,r)}getBounds(){return this._assertInitialized(),this.googleMap.getBounds()||null}getCenter(){return this._assertInitialized(),this.googleMap.getCenter()}getClickableIcons(){return this._assertInitialized(),this.googleMap.getClickableIcons()}getHeading(){return this._assertInitialized(),this.googleMap.getHeading()}getMapTypeId(){return this._assertInitialized(),this.googleMap.getMapTypeId()}getProjection(){return this._assertInitialized(),this.googleMap.getProjection()||null}getStreetView(){return this._assertInitialized(),this.googleMap.getStreetView()}getTilt(){return this._assertInitialized(),this.googleMap.getTilt()}getZoom(){return this._assertInitialized(),this.googleMap.getZoom()}get controls(){return this._assertInitialized(),this.googleMap.controls}get data(){return this._assertInitialized(),this.googleMap.data}get mapTypes(){return this._assertInitialized(),this.googleMap.mapTypes}get overlayMapTypes(){return this._assertInitialized(),this.googleMap.overlayMapTypes}_resolveMap(){return this.googleMap?Promise.resolve(this.googleMap):this.mapInitialized.pipe(re(1)).toPromise()}_setSize(){if(this._mapEl){let n=this._mapEl.style;n.height=this.height===null?"":Hi(this.height)||Gi,n.width=this.width===null?"":Hi(this.width)||Ui}}_combineOptions(){let n=this._options||{};return w(S({},n),{center:this._center||n.center||qe.center,zoom:this._zoom??n.zoom??qe.zoom,mapTypeId:this.mapTypeId||n.mapTypeId||qe.mapTypeId,mapId:this.mapId||n.mapId})}_assertInitialized(){this.googleMap}};e.\u0275fac=function(r){return new(r||e)(ae(bt),ae(ge),ae(Ii))},e.\u0275cmp=k({type:e,selectors:[["google-map"]],inputs:{height:"height",width:"width",mapId:"mapId",mapTypeId:"mapTypeId",center:"center",zoom:"zoom",options:"options"},outputs:{mapInitialized:"mapInitialized",authFailure:"authFailure",boundsChanged:"boundsChanged",centerChanged:"centerChanged",mapClick:"mapClick",mapDblclick:"mapDblclick",mapDrag:"mapDrag",mapDragend:"mapDragend",mapDragstart:"mapDragstart",headingChanged:"headingChanged",idle:"idle",maptypeidChanged:"maptypeidChanged",mapMousemove:"mapMousemove",mapMouseout:"mapMouseout",mapMouseover:"mapMouseover",projectionChanged:"projectionChanged",mapRightclick:"mapRightclick",tilesloaded:"tilesloaded",tiltChanged:"tiltChanged",zoomChanged:"zoomChanged"},exportAs:["googleMap"],standalone:!0,features:[ai,Mi],ngContentSelectors:Cn,decls:2,vars:0,consts:[[1,"map-container"]],template:function(r,l){r&1&&(oi(),A(0,"div",0),si(1))},encapsulation:2,changeDetection:0});let i=e;return i})(),vn=/([A-Za-z%]+)$/;function Hi(i){return i==null?"":vn.test(i)?i:`${i}px`}var Tt=(()=>{let e=class e{set options(n){this._options.next(n||{})}set position(n){this._position.next(n)}constructor(n,r,l){this._googleMap=n,this._elementRef=r,this._ngZone=l,this._eventManager=new Qe(g(ge)),this._options=new yt({}),this._position=new yt(void 0),this._destroy=new yi,this.closeclick=this._eventManager.getLazyEmitter("closeclick"),this.contentChanged=this._eventManager.getLazyEmitter("content_changed"),this.domready=this._eventManager.getLazyEmitter("domready"),this.positionChanged=this._eventManager.getLazyEmitter("position_changed"),this.zindexChanged=this._eventManager.getLazyEmitter("zindex_changed"),this.infoWindowInitialized=new R}ngOnInit(){this._googleMap._isBrowser&&this._combineOptions().pipe(re(1)).subscribe(n=>{google.maps.InfoWindow?this._initialize(google.maps.InfoWindow,n):this._ngZone.runOutsideAngular(()=>{google.maps.importLibrary("maps").then(r=>{this._initialize(r.InfoWindow,n)})})})}_initialize(n,r){this._ngZone.runOutsideAngular(()=>{this.infoWindow=new n(r),this._eventManager.setTarget(this.infoWindow),this.infoWindowInitialized.emit(this.infoWindow),this._watchForOptionsChanges(),this._watchForPositionChanges()})}ngOnDestroy(){this._eventManager.destroy(),this._destroy.next(),this._destroy.complete(),this.infoWindow&&this.close()}close(){this._assertInitialized(),this.infoWindow.close()}getContent(){return this._assertInitialized(),this.infoWindow.getContent()||null}getPosition(){return this._assertInitialized(),this.infoWindow.getPosition()||null}getZIndex(){return this._assertInitialized(),this.infoWindow.getZIndex()}openAdvancedMarkerElement(n,r){this.open({getAnchor:()=>n},void 0,r)}open(n,r,l){this._assertInitialized();let v=n?n.getAnchor():void 0;(this.infoWindow.get("anchor")!==v||!v)&&(this._elementRef.nativeElement.style.display="",l&&this.infoWindow.setContent(l),this.infoWindow.open({map:this._googleMap.googleMap,anchor:v,shouldFocus:r}))}_combineOptions(){return bi([this._options,this._position]).pipe(V(([n,r])=>w(S({},n),{position:r||n.position,content:this._elementRef.nativeElement})))}_watchForOptionsChanges(){this._options.pipe(ni(this._destroy)).subscribe(n=>{this._assertInitialized(),this.infoWindow.setOptions(n)})}_watchForPositionChanges(){this._position.pipe(ni(this._destroy)).subscribe(n=>{n&&(this._assertInitialized(),this.infoWindow.setPosition(n))})}_assertInitialized(){}};e.\u0275fac=function(r){return new(r||e)(ae(Et),ae(bt),ae(ge))},e.\u0275dir=ri({type:e,selectors:[["map-info-window"]],hostAttrs:[2,"display","none"],inputs:{options:"options",position:"position"},outputs:{closeclick:"closeclick",contentChanged:"contentChanged",domready:"domready",positionChanged:"positionChanged",zindexChanged:"zindexChanged",infoWindowInitialized:"infoWindowInitialized"},exportAs:["mapInfoWindow"],standalone:!0});let i=e;return i})();var yn={position:{lat:37.221995,lng:-122.184092}},Wi=(()=>{let e=class e{set title(n){this._title=n}set position(n){this._position=n}set content(n){this._content=n}set gmpDraggable(n){this._draggable=n}set options(n){this._options=n}set zIndex(n){this._zIndex=n}constructor(n,r){this._googleMap=n,this._ngZone=r,this._eventManager=new Qe(g(ge)),this.mapClick=this._eventManager.getLazyEmitter("click"),this.mapDrag=this._eventManager.getLazyEmitter("drag"),this.mapDragend=this._eventManager.getLazyEmitter("dragend"),this.mapDragstart=this._eventManager.getLazyEmitter("dragstart"),this.markerInitialized=new R}ngOnInit(){this._googleMap._isBrowser&&(google.maps.marker?.AdvancedMarkerElement&&this._googleMap.googleMap?this._initialize(this._googleMap.googleMap,google.maps.marker.AdvancedMarkerElement):this._ngZone.runOutsideAngular(()=>{Promise.all([this._googleMap._resolveMap(),google.maps.importLibrary("marker")]).then(([n,r])=>{this._initialize(n,r.AdvancedMarkerElement)})}))}_initialize(n,r){this._ngZone.runOutsideAngular(()=>{this.advancedMarker=new r(this._combineOptions()),this._assertInitialized(),this.advancedMarker.map=n,this._eventManager.setTarget(this.advancedMarker),this.markerInitialized.next(this.advancedMarker)})}ngOnChanges(n){let{advancedMarker:r,_content:l,_position:v,_title:Y,_draggable:ii,_zIndex:_n}=this;r&&(n.title&&(r.title=Y),n.content&&(r.content=l),n.gmpDraggable&&(r.gmpDraggable=ii),n.content&&(r.content=l),n.position&&(r.position=v),n.zIndex&&(r.zIndex=_n))}ngOnDestroy(){this.markerInitialized.complete(),this._eventManager.destroy(),this.advancedMarker&&(this.advancedMarker.map=null)}getAnchor(){return this._assertInitialized(),this.advancedMarker}_combineOptions(){let n=this._options||yn;return w(S({},n),{title:this._title||n.title,position:this._position||n.position,content:this._content||n.content,zIndex:this._zIndex??n.zIndex,gmpDraggable:this._draggable??n.gmpDraggable,map:this._googleMap.googleMap})}_assertInitialized(){}};e.\u0275fac=function(r){return new(r||e)(ae(Et),ae(ge))},e.\u0275dir=ri({type:e,selectors:[["map-advanced-marker"]],inputs:{title:"title",position:"position",content:"content",gmpDraggable:"gmpDraggable",options:"options",zIndex:"zIndex"},outputs:{mapClick:"mapClick",mapDrag:"mapDrag",mapDragend:"mapDragend",mapDragstart:"mapDragstart",markerInitialized:"markerInitialized"},exportAs:["mapAdvancedMarker"],standalone:!0,features:[ai]});let i=e;return i})();var qi=(()=>{let e=class e{};e.\u0275fac=function(r){return new(r||e)},e.\u0275mod=me({type:e}),e.\u0275inj=pe({});let i=e;return i})();var In=()=>({exact:!0}),se=class i{sideBarVisible=f(!1);router=g(Ae);get sideBarVisibleSig(){return this.sideBarVisible()}set sideBarVisibleSig(e){this.sideBarVisible.set(e)}toggleSideBar(){this.sideBarVisible.set(!this.sideBarVisible())}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=k({type:i,selectors:[["app-navigation"]],decls:11,vars:2,consts:[[1,"wrapper"],[1,"nav"],["routerLink","/admin/stations","routerLinkActive","active","ariaCurrentWhenActive","page"],[1,"line"],["routerLink","/admin/carriages","routerLinkActive","active","ariaCurrentWhenActive","page"],["routerLink","/admin/routes","routerLinkActive","active","ariaCurrentWhenActive","page",3,"routerLinkActiveOptions"]],template:function(t,n){t&1&&(o(0,"div",0)(1,"nav",1)(2,"a",2),p(3,"Stations"),a(),A(4,"div",3),o(5,"a",4),p(6,"Carriages"),a(),A(7,"div",3),o(8,"a",5),p(9,"Routes"),a(),A(10,"div",3),a()()),t&2&&(s(8),c("routerLinkActiveOptions",oe(1,In)))},dependencies:[zi,Ri],styles:[".wrapper[_ngcontent-%COMP%]{width:100%;margin:0 auto}.wrapper[_ngcontent-%COMP%]   .nav[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:1rem;font:var(--primary-sm-font);width:100%;max-width:10rem;font-weight:var(--primary-md-font-weight);height:100vh}.wrapper[_ngcontent-%COMP%]   .nav[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]{color:var(--color-primary-a50);font-weight:var(--primary-lg-font-weight)}.wrapper[_ngcontent-%COMP%]   .nav[_ngcontent-%COMP%]   .line[_ngcontent-%COMP%]{margin-top:.5rem;margin-bottom:.5rem;width:100%;height:1px;background-color:var(--color-secondary-a30)}.wrapper[_ngcontent-%COMP%]   .nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{transition:all .3s ease-out;text-decoration:none;color:#000}.wrapper[_ngcontent-%COMP%]   .nav[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:var(--color-primary-b40)}"],changeDetection:0})};var Qi=i=>Number(i.value)>=-90&&Number(i.value)<=90?null:{latitudeNumberValidator:!0};var Ki=i=>Number(i.value)>=-180&&Number(i.value)<=180?null:{longitudeNumberValidator:!0};var Yi=i=>{let e=i.get("carriages"),t=i.get("stations");return e.length<4||t.length<4?{routeFormValid:!0}:null};var $=M("[Admin] Set loading",z()),fe=M("[Admin] Set Alert",z()),Ie=M("[Admin Page] Get Stations"),_i=M("[Admin Page] Get Routes"),Pe=M("[Admin Page] Get Carriages"),K=M("[Admin Page] Failed"),Le=M("[Admin Page] Update Stations",z()),Pt=M("[Admin Page] Update Routes",z()),Ke=M("[Admin Page] Add Station",z()),Ye=M("[Admin Page] Add Station In Store",z()),Se=M("[Admin Page] Delete Station",z()),Je=M("[Admin Page] Delete Station In Store",z()),Fe=M("[Admin Page] Set Show Data",z()),Lt=M("[Admin Page] Update Show Data",z()),Xe=M("[Admin Page] Update Carriages",z()),et=M("[Admin Page] Delete Router",z()),tt=M("[Admin Page] Delete Router In Store",z()),Ft=M("[Admin Page] Clear Show Data"),it=M("[Admin Page] Update Router",z()),nt=M("[Admin Page] Update Router In Store",z()),rt=M("[Admin Page] Create Router",z()),at=M("[Admin Page] Create Router In Store",z()),ot=M("[Admin Page] Get Ride",z()),st=M("[Admin Page] Update Ride",z()),lt=M("[Admin Page] Update Ride Data",z()),dt=M("[Admin Page] Update Ride Data In Store",z()),ct=M("[Admin Page] Create Ride",z()),pt=M("[Admin Page] Create Ride In Store",z()),mt=M("[Admin Page] Delete Ride",z()),gt=M("[Admin Page] Delete Ride In Store",z()),ut=M("[Admin Page] Create Carriages Data",z()),ht=M("[Admin Page] Create Carriages Data In Store",z()),_t=M("[Admin Page] Update Carriages Data",z()),ft=M("[Admin Page] Update Carriages Data In Store",z()),we=M("[Admin Page] Delete Carriages",z()),Ct=M("[Admin Page] Delete Carriages In Store",z());function Sn(i,e){i&1&&(o(0,"div",6),p(1,"The name should be unique"),a())}function wn(i,e){i&1&&(o(0,"div",6),p(1,"Enter a number between -90 and 90"),a())}function Mn(i,e){i&1&&(o(0,"div",6),p(1,"The station with such coordinates exists"),a())}function xn(i,e){i&1&&(o(0,"div",6),p(1,"Enter a number between -180 and 180"),a())}function kn(i,e){i&1&&(o(0,"div",6),p(1,"The station with such coordinates exists"),a())}function An(i,e){if(i&1&&(o(0,"option",16),p(1),a()),i&2){let t=e.$implicit,n=d(2);c("value",t.id)("disabled",n.checkSelect(t.id)),s(),L(" ",t.city," ")}}function Dn(i,e){if(i&1){let t=b();o(0,"div",13)(1,"select",15),m("change",function(){u(t);let r=d();return h(r.changeSelect())}),O(2,An,2,3,"option",16,H),a()()}if(i&2){let t=e.$index,n=d();s(),Ue("formControlName",t),s(),E(n.dataInput)}}var Vt=class i{dataInput=[];userMarkInput={show:!1,lat:0,lng:0,city:""};changed=new R;formBuilder=g(Te);store=g(T);form=this.formBuilder.group({cityName:["",{validators:[J.required,this.uniqNameValid.bind(this)],updateOn:"blur"}],latitude:["",{validators:[J.required,Qi,this.uniqCordValid.bind(this)],updateOn:"blur"}],longitude:["",{validators:[J.required,Ki,this.uniqCordValid.bind(this)],updateOn:"blur"}],connected:this.formBuilder.array([this.formBuilder.control("",{validators:[J.required],updateOn:"change"})])});userMark=f({show:!1,lat:NaN,lng:NaN,city:""});uniqNameValid(e){return this.dataInput?.map(t=>t.city).includes(e.value.trim())?{uniqNameValid:!0}:null}uniqCordValid(){return this.form&&!(this.dataInput?.map(e=>e.lat).includes(Number(this.form.value.latitude))&&this.dataInput?.map(e=>e.lon).includes(Number(this.form.value.longitude)))?null:{uniqCordValid:!0}}getFormsControls(){return this.form.controls.connected}changeSelect(){this.form.controls.connected.value.includes("")||this.form.controls.connected.push(this.formBuilder.control("",{updateOn:"change"}))}changeLatitude(e){this.form.controls.latitude.setValue(e),this.userMark.update(t=>w(S({},t),{lat:Number(this.form.value.latitude)})),this.onChange(this.userMark())}changeLongitude(e){this.form.controls.longitude.setValue(e),this.userMark.update(t=>w(S({},t),{lng:Number(this.form.value.longitude)})),this.onChange(this.userMark())}onChange(e){this.changed.emit(e)}checkSelect(e){return this.form.controls.connected.value.includes(String(e))}changeCityName(){this.userMark.update(e=>w(S({},e),{city:this.form.value.cityName}))}handleSubmit(){if(this.form.valid){let e={city:String(this.form.value.cityName).trim(),latitude:Number(this.form.value.latitude),longitude:Number(this.form.value.longitude),relations:this.form.value.connected.filter(t=>t!=="").map(t=>Number(t))};this.store.dispatch(Ke({station:e}))}else this.form.markAllAsTouched()}ngDoCheck(){this.userMarkInput.show&&(this.form.controls.latitude.setValue(String(this.userMarkInput.lat)),this.form.controls.longitude.setValue(String(this.userMarkInput.lng)),this.form.controls.longitude.markAsTouched(),this.form.controls.latitude.markAsTouched()),this.userMark.update(e=>w(S({},e),{lat:this.userMarkInput.lat,lng:this.userMarkInput.lng,show:this.userMarkInput.show}))}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=k({type:i,selectors:[["app-form-station"]],inputs:{dataInput:"dataInput",userMarkInput:"userMarkInput"},outputs:{changed:"changed"},decls:27,vars:9,consts:[["latitude",""],["longitude",""],[1,"form",3,"submit","formGroup"],[1,"form__line"],["for","cityName",1,"line__label"],["type","text","id","cityName","formControlName","cityName",1,"line__input",3,"input"],[1,"alert"],["for","latitude",1,"line__label"],["type","number","id","latitude","formControlName","latitude",1,"line__input",3,"input","value"],["for","longitude",1,"line__label"],["type","number","id","longitude","formControlName","longitude",1,"line__input",3,"input","value"],[1,"line__label"],["formArrayName","connected"],[1,"content_input"],["type","submit","disabled","form.invalid","label","Save",3,"rounded"],["id","connected","name","connected",1,"line__input",3,"change","formControlName"],[3,"value","disabled"]],template:function(t,n){if(t&1){let r=b();o(0,"form",2),m("submit",function(){return u(r),h(n.handleSubmit())}),o(1,"div",3)(2,"label",4),p(3,"City Name"),a(),o(4,"input",5),m("input",function(){return u(r),h(n.changeCityName())}),a(),y(5,Sn,2,0,"div",6),a(),o(6,"div",3)(7,"label",7),p(8,"Latitude"),a(),o(9,"input",8,0),m("input",function(){u(r);let v=ye(10);return h(n.changeLatitude(v.value))}),a(),y(11,wn,2,0,"div",6)(12,Mn,2,0,"div",6),a(),o(13,"div",3)(14,"label",9),p(15,"Longitude"),a(),o(16,"input",10,1),m("input",function(){u(r);let v=ye(17);return h(n.changeLongitude(v.value))}),a(),y(18,xn,2,0,"div",6)(19,kn,2,0,"div",6),a(),o(20,"div",3)(21,"p",11),p(22,"Connected"),a(),o(23,"div",12),O(24,Dn,4,1,"div",13,H),a()(),A(26,"p-button",14),a()}t&2&&(c("formGroup",n.form),s(5),C(n.form.controls.cityName.errors!=null&&n.form.controls.cityName.errors.uniqNameValid?5:-1),s(4),c("value",n.userMarkInput.lat),s(2),C(n.form.controls.latitude.errors!=null&&n.form.controls.latitude.errors.latitudeNumberValidator?11:-1),s(),C(n.form.controls.latitude.errors!=null&&n.form.controls.latitude.errors.uniqCordValid?12:-1),s(4),c("value",n.userMarkInput.lng),s(2),C(n.form.controls.longitude.errors!=null&&n.form.controls.longitude.errors.longitudeNumberValidator?18:-1),s(),C(n.form.controls.longitude.errors!=null&&n.form.controls.longitude.errors.uniqCordValid?19:-1),s(5),E(n.getFormsControls().controls),s(2),c("rounded",!0))},dependencies:[Re,zt,Rt,xt,kt,Dt,De,ze,Oe,Ee,At,N],styles:["*[_ngcontent-%COMP%]{margin:0;padding:0}.form[_ngcontent-%COMP%]{width:100%}.form__line[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-bottom:1rem;width:100%;max-width:20rem}.line__label[_ngcontent-%COMP%]{font-weight:var(--primary-md-font-weight);margin-bottom:1rem}.line__input[_ngcontent-%COMP%]{height:1.5rem;outline:none;border-radius:1rem;padding-left:.5rem;font:var(--primary-sm-font);width:100%;margin-bottom:.5rem}.line__input[_ngcontent-%COMP%]:hover{outline:1px solid var(--primary-button-hover-color)}.line__input[_ngcontent-%COMP%]:focus{outline:1px solid var(--primary-button-hover-color)}.alert[_ngcontent-%COMP%]{font-size:12px;color:var(--primary-error-color)}input.ng-touched.ng-invalid[_ngcontent-%COMP%]{border:1px solid var(--primary-error-border-color)}input.ng-touched.ng-valid[_ngcontent-%COMP%]{border:1px solid var(--primary-success-border-color)}select.ng-touched.ng-invalid[_ngcontent-%COMP%]{border:1px solid var(--primary-error-border-color)}select.ng-touched.ng-valid[_ngcontent-%COMP%]{border:1px solid var(--primary-success-border-color)}"]})};var q=Ni("admin"),Ce=Z(q,i=>i.isLoading),Nt=Z(q,i=>i.isAlert),$t=Z(q,i=>i.stations),Xi=Z(q,i=>i.routes),en=Z(q,i=>i.showData),Bt=Z(q,i=>i.carriages),tn=Z(q,i=>[...i.stations].map(e=>({id:e.id,city:e.city,connectedTo:e.connectedTo,lat:e.latitude,lon:e.longitude}))),nn=Z(q,i=>[...i.stations].map(e=>({lat:e.latitude,lng:e.longitude,city:e.city}))),rn=i=>Z(q,e=>[...e.stations].filter(t=>i.includes(t.id)).map(t=>t.city).join(" ")),an=i=>Z(q,e=>new Set([...e.routes].map(t=>t.path).flat()).has(i)),on=i=>Z(q,e=>[...e.routes].find(t=>t.id===i)?.path.map(t=>[...e.stations].find(n=>n.id===t)?.city).join(" - ")),sn=i=>Z(q,e=>[...e.routes].find(t=>t.id===i)?.carriages.map(t=>[...e.carriages].find(n=>n.code===t)?.name).join(" - "));var ln=Z(q,i=>i.ride),jt=Z(q,i=>i.ride.path.map(e=>i.stations.find(t=>t.id===e)?.city).slice(0,-1)),fi=Z(q,i=>({price:Object.fromEntries(i.ride.carriages.map(e=>i.carriages.find(t=>t.code===e)?.name).map(e=>[e,-1]))})),dn=i=>Z(q,e=>e.carriages.map(t=>t.name).includes(i)),cn=i=>Z(q,e=>new Set(e.routes.map(t=>t.carriages).flat()).has(i));var Zt=class i{data={id:0,city:"",connectedTo:[{id:0,distance:0}],latitude:0,longitude:0};connects$=new ie;active$=new ie;messageService=g(Ot);store=g(T);ngOnInit(){let e=this.data?.connectedTo.map(t=>t.id);e&&(this.connects$=this.store.select(rn(e)),this.active$=this.store.select(an(this.data.id)))}handleClickDelete(){this.active$.pipe(re(1)).subscribe(e=>{e?(this.messageService.add({severity:"error",summary:"Error",detail:"You can not delete this station"}),this.store.dispatch(fe({isAlert:!0}))):this.data?.id&&this.store.dispatch(Se({id:this.data?.id}))})}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=k({type:i,selectors:[["app-station-info"]],inputs:{data:"data"},decls:14,vars:16,consts:[[1,"wrapper"],[1,"title"],[1,"cord"],[1,"title_connects"],[1,"connects"],["type","button","icon","pi pi-trash",1,"delete",3,"click","text"]],template:function(t,n){t&1&&(o(0,"div",0)(1,"h3",1),p(2),I(3,"async"),a(),o(4,"p",2),p(5),I(6,"number"),I(7,"number"),a(),o(8,"p",3),p(9,"Connected to:"),a(),o(10,"p",4),p(11),I(12,"async"),a(),o(13,"p-button",5),m("click",function(){return n.handleClickDelete()}),a()()),t&2&&(s(2),li("",n.data==null?null:n.data.city," (",D(3,6,n.active$)?"Active":"Inactive",")"),s(3),li(" ",di(6,8,n.data==null?null:n.data.latitude,"1.1-4"),", ",di(7,11,n.data==null?null:n.data.longitude,"1.1-4")," "),s(6),ee(D(12,14,n.connects$)),s(2),c("text",!0))},dependencies:[N,W,Ai],styles:["*[_ngcontent-%COMP%]{margin:0;padding:0}.wrapper[_ngcontent-%COMP%]{width:100%;margin-bottom:1rem;border:1px solid var(--color-secondary-a10);border-radius:1rem;box-sizing:border-box;padding:1rem;position:relative}.wrapper[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .wrapper[_ngcontent-%COMP%]   .cord[_ngcontent-%COMP%]{margin-bottom:.5rem}.wrapper[_ngcontent-%COMP%]   .delete[_ngcontent-%COMP%]{position:absolute;top:.2rem;right:.2rem;cursor:pointer;transition:all .3s ease-out}.wrapper[_ngcontent-%COMP%]   .delete[_ngcontent-%COMP%]:hover{transform:scale(1.2)}"],changeDetection:0})};var zn=i=>({error:i}),de=class i{error=!1;text="";static \u0275fac=function(t){return new(t||i)};static \u0275cmp=k({type:i,selectors:[["app-message"]],inputs:{error:"error",text:"text"},decls:2,vars:4,consts:[[1,"alert",3,"ngClass"]],template:function(t,n){t&1&&(o(0,"p",0),p(1),a()),t&2&&(c("ngClass",He(2,zn,n.error)),s(),L(" ",n.text,`
`))},dependencies:[wt],styles:["*[_ngcontent-%COMP%]{margin:0;padding:0}.alert[_ngcontent-%COMP%]{width:100%;position:fixed;padding:.5rem;top:0;left:50%;transform:translate(-50%);display:flex;justify-content:center;align-items:center;border-radius:5%;color:var(--primary-button-text-color);max-width:100rem;z-index:9999;text-align:center}.error[_ngcontent-%COMP%]{background-color:var(--primary-error-color)}"],changeDetection:0})};var Rn=(i,e)=>e.id,On=(i,e)=>e.code,Ci=()=>[];function En(i,e){if(i&1&&(o(0,"option",13),p(1),a()),i&2){let t=e.$implicit;c("value",t.id),s(),L(" ",t.city," ")}}function Tn(i,e){if(i&1){let t=b();o(0,"div",5)(1,"select",12),m("change",function(){let r=u(t).$index,l=d();return h(l.changeSelectStation(r))}),O(2,En,2,2,"option",13,Rn),I(4,"async"),a()()}if(i&2){let t=e.$index,n=d();s(),Ue("formControlName",t),s(),E((D(4,1,n.showData$)||oe(3,Ci))[t])}}function Pn(i,e){if(i&1&&(o(0,"option",13),p(1),a()),i&2){let t=e.$implicit;c("value",t.code),s(),L(" ",t.name," ")}}function Ln(i,e){if(i&1){let t=b();o(0,"div",15)(1,"p-button",16),m("click",function(){u(t);let r=d().$index,l=d();return h(l.changeDelete(r))}),a()()}i&2&&(s(),c("text",!0))}function Fn(i,e){if(i&1){let t=b();o(0,"div",5)(1,"select",14),m("change",function(){u(t);let r=d();return h(r.changeSelectCarriages())}),O(2,Pn,2,2,"option",13,On),I(4,"async"),a(),y(5,Ln,2,1,"div",15),a()}if(i&2){let t=e.$index,n=d();s(),Ue("formControlName",t),s(),E(D(4,2,n.dataCarriages$)||oe(4,Ci)),s(3),C((n.form.value.carriages||oe(5,Ci)).length>2&&t!==n.getFormsControlsCarriages().controls.length-1?5:-1)}}function Vn(i,e){i&1&&(o(0,"div",7),p(1,"Minimum 3 carriages and minimum 3 stations"),a())}function Nn(i,e){if(i&1){let t=b();o(0,"p-button",17),m("click",function(){u(t);let r=d();return h(r.handleUpdate())}),a()}if(i&2){let t=d();c("rounded",!0)("disabled",t.form.invalid)}}function $n(i,e){if(i&1){let t=b();o(0,"p-button",18),m("click",function(){u(t);let r=d();return h(r.handleSubmit())}),a()}if(i&2){let t=d();c("rounded",!0)("disabled",t.form.invalid)}}var Gt=class i{data={data:{id:-1,carriages:[],path:[]},update:!1,checkUpdate:!1};changed=new R;formBuilder=g(Te);store=g(T);ref=g(ci);form=this.formBuilder.group({stations:this.formBuilder.array([this.formBuilder.control("",{validators:[J.required],updateOn:"change"})]),carriages:this.formBuilder.array([this.formBuilder.control("",{validators:[J.required],updateOn:"change"})])},{validators:Yi});data$=this.store.select($t);dataUpdate$=new ie;fillData$=f({id:-1,path:[],carriages:[]});dataCarriages$=this.store.select(Bt);showData$=this.store.select(en);getFormsControlsStation(){return this.form.controls.stations}getFormsControlsCarriages(){return this.form.controls.carriages}changeSelectCarriages(){this.form.controls.carriages.value.includes("")||this.form.controls.carriages.push(this.formBuilder.control("",{updateOn:"change"}))}changeSelectStation(e){if(this.form.controls.stations.value.includes("")||this.form.controls.stations.push(this.formBuilder.control("",{updateOn:"change"})),this.form.controls.stations.value.length-2!==e){let t=this.form.value.stations,n=[...this.form.value.stations?.slice(0,e+1),""];this.form.controls.stations.reset(n);for(let r=0;r<t.length-n.length;r+=1)this.form.controls.stations.removeAt(n.length);this.store.dispatch(Lt({id:e+1}))}this.store.dispatch(Fe({id:e+1,valueForm:this.form.value.stations}))}checkSelect(e){return this.form.controls.carriages.value.includes(String(e))}checkSelectStation(e){return this.form.controls.stations.value.includes(String(e))}changeDelete(e){let t=[...this.form.value.carriages?.filter((n,r)=>r!==e),""];this.form.controls.carriages.reset(t),this.form.controls.carriages.removeAt(t.length-1)}handleSubmit(){if(this.form.valid){let e={id:this.data?.data.id,carriages:this.form.value.carriages?.slice(0,-1),path:this.form.value.stations?.map(t=>Number(t))?.slice(0,-1)};this.store.dispatch(rt({data:e})),this.changed.emit(!1)}}handleUpdate(){if(this.form.valid){let e={id:this.data?.data.id,carriages:this.form.value.carriages?.slice(0,-1),path:this.form.value.stations?.map(t=>Number(t))?.slice(0,-1)};this.store.dispatch(it({data:e})),this.changed.emit(!1)}}updateForm(){let e=[...this.fillData$().carriages,""],t=[...this.fillData$().path.map(n=>String(n)),""];this.form.controls.carriages.reset(e),this.form.controls.stations.reset(t),this.form.controls.carriages.clear(),this.form.controls.stations.clear(),e.forEach((n,r)=>{r<3?this.form.controls.carriages.push(this.formBuilder.control("",{validators:[J.required],updateOn:"change"})):this.form.controls.carriages.push(this.formBuilder.control("",{updateOn:"change"}))}),t.forEach((n,r)=>{r<3?this.form.controls.stations.push(this.formBuilder.control("",{validators:[J.required],updateOn:"change"})):this.form.controls.stations.push(this.formBuilder.control("",{updateOn:"change"}))}),this.store.dispatch(Ft()),t?.slice(0,-1).forEach((n,r)=>{this.store.dispatch(Fe({id:r+1,valueForm:t}))}),this.form.controls.carriages.reset(e),this.form.controls.stations.reset(t),this.form.updateValueAndValidity()}ngOnInit(){this.store.dispatch(Fe({id:0,valueForm:[]}))}ngAfterViewChecked(){this.data?.checkUpdate&&this.data.update&&(this.fillData$.set(this.data.data),this.updateForm(),this.data.update=!1)}handleClickCancel(){this.changed.emit(!1)}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=k({type:i,selectors:[["app-form-router"]],inputs:{data:"data"},outputs:{changed:"changed"},decls:19,vars:4,consts:[[1,"form",3,"submit","formGroup"],[1,"content_selection"],[1,"form__line"],[1,"line__label"],["formArrayName","stations"],[1,"content_input"],["formArrayName","carriages"],[1,"alert"],[1,"buttons_content"],["type","button","label","Update",3,"rounded","disabled"],["type","button","label","Save",3,"rounded","disabled"],["label","Cancel","type","button",3,"click","rounded"],["id","connected","name","connected",1,"line__input",3,"change","formControlName"],[3,"value"],["id","connected","name","connected",1,"line__input","select_carriage",3,"change","formControlName"],[1,"delete"],["icon","pi pi-times","type","button",3,"click","text"],["type","button","label","Update",3,"click","rounded","disabled"],["type","button","label","Save",3,"click","rounded","disabled"]],template:function(t,n){t&1&&(o(0,"form",0),m("submit",function(){return n.handleSubmit()}),o(1,"div",1)(2,"div",2)(3,"p",3),p(4,"Stations"),a(),o(5,"div",4),O(6,Tn,5,4,"div",5,H),a()(),o(8,"div",2)(9,"p",3),p(10,"Carriages"),a(),o(11,"div",6),O(12,Fn,6,6,"div",5,H),a()()(),y(14,Vn,2,0,"div",7),o(15,"div",8),y(16,Nn,1,2,"p-button",9)(17,$n,1,2,"p-button",10),o(18,"p-button",11),m("click",function(){return n.handleClickCancel()}),a()()()),t&2&&(c("formGroup",n.form),s(6),E(n.getFormsControlsStation().controls),s(6),E(n.getFormsControlsCarriages().controls),s(2),C(n.form.errors!=null&&n.form.errors.routeFormValid?14:-1),s(2),C(n.fillData$().id>=0?16:17),s(2),c("rounded",!0))},dependencies:[Re,zt,Rt,Dt,De,ze,Oe,Ee,At,N,W],styles:["*[_ngcontent-%COMP%]{margin:0;padding:0}.form[_ngcontent-%COMP%]{display:flex;width:100%;flex-direction:column;margin-bottom:1rem}.content_selection[_ngcontent-%COMP%]{display:flex;width:100%;justify-content:space-around;margin-bottom:1rem}.alert[_ngcontent-%COMP%]{margin-bottom:1rem}.buttons_content[_ngcontent-%COMP%]{display:flex;justify-content:space-around}.alert[_ngcontent-%COMP%]{align-self:center}.form__line[_ngcontent-%COMP%]{width:30%}.line__label[_ngcontent-%COMP%]{margin-bottom:1rem;text-align:center}.line__input[_ngcontent-%COMP%]{width:100%;margin-bottom:1rem;border-radius:5%;padding:.5rem}.content_input[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.select_carriage[_ngcontent-%COMP%]{margin-right:1rem}"],changeDetection:0})};function Bn(i,e){if(i&1){let t=b();o(0,"app-confirm",10),m("changed",function(r){u(t);let l=d();return h(l.onDeleteNo(r))})("yesDelete",function(r){u(t);let l=d();return h(l.onDeleteYes(r))}),a()}if(i&2){let t=d();c("data",t.data.id)}}var Ne=class i{data={id:-1,carriages:[""],path:[0]};changed=new R;changedDelete=new R;store=g(T);router=g(Ae);cities$=new ie;carriages$=new ie;showConfirm$=f(!1);ngOnInit(){this.cities$=this.store.select(on(this.data.id)),this.carriages$=this.store.select(sn(this.data.id))}onDeleteNo(e){this.showConfirm$.set(e)}onDeleteYes(e){this.changedDelete.emit(e)}handleClickDelete(){this.showConfirm$.set(!0)}handleClickEdit(){this.data&&this.changed.emit(this.data)}handleClickRide(){this.router.navigate(["admin","routes",this.data?.id])}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=k({type:i,selectors:[["app-router-info"]],inputs:{data:"data"},outputs:{changed:"changed",changedDelete:"changedDelete"},decls:18,vars:11,consts:[[1,"wrapper"],[1,"title"],[1,"title_connects"],[1,"connects","first_connect"],[1,"connects"],[1,"actions"],["type","button","icon","pi pi-pencil",1,"icon",3,"click","text"],["type","button","icon","pi pi-truck",1,"icon",3,"click","text"],["type","button","icon","pi pi-trash",1,"icon",3,"click","text"],[3,"data"],[3,"changed","yesDelete","data"]],template:function(t,n){t&1&&(o(0,"div",0)(1,"h3",1),p(2),a(),o(3,"p",2),p(4,"Cities:"),a(),o(5,"p",3),p(6),I(7,"async"),a(),o(8,"p",2),p(9,"Carriage Types:"),a(),o(10,"p",4),p(11),I(12,"async"),a(),o(13,"div",5)(14,"p-button",6),m("click",function(){return n.handleClickEdit()}),a(),o(15,"p-button",7),m("click",function(){return n.handleClickRide()}),a(),o(16,"p-button",8),m("click",function(){return n.handleClickDelete()}),a()(),y(17,Bn,1,1,"app-confirm",9),a()),t&2&&(s(2),L("Route ",n.data==null?null:n.data.id,""),s(4),ee(D(7,7,n.cities$)),s(5),ee(D(12,9,n.carriages$)),s(3),c("text",!0),s(),c("text",!0),s(),c("text",!0),s(),C(n.showConfirm$()?17:-1))},styles:["*[_ngcontent-%COMP%]{margin:0;padding:0}.wrapper[_ngcontent-%COMP%]{width:100%;margin-bottom:1rem;border:1px solid var(--color-secondary-a10);border-radius:1rem;box-sizing:border-box;padding:1rem;position:relative}.wrapper[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%], .wrapper[_ngcontent-%COMP%]   .first_connect[_ngcontent-%COMP%]{margin-bottom:.5rem}.wrapper[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{position:absolute;top:1rem;right:1rem;display:flex;justify-content:space-around}.wrapper[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]:hover{transform:var(--primary-icon-transform)}"],changeDetection:0})};var vt=class i{data=-1;ride=!1;changed=new R;yesDelete=new R;store=g(T);ngOnInit(){confirm("Are you sure you want to delete this item?")?this.handleClickYes():this.handleClickNo()}handleClickYes(){this.ride?(this.yesDelete.emit(!0),this.changed.emit(!1)):(this.store.dispatch(et({id:this.data})),this.yesDelete.emit(!0),this.handleClickNo())}handleClickNo(){this.changed.emit(!1)}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=k({type:i,selectors:[["app-confirm"]],inputs:{data:"data",ride:"ride"},outputs:{changed:"changed",yesDelete:"yesDelete"},decls:0,vars:0,template:function(t,n){},changeDetection:0})};var jn=()=>[];function Zn(i,e){if(i&1){let t=b();o(0,"app-confirm",6),m("changed",function(r){u(t);let l=d();return h(l.onChangeDelete(r))})("yesDelete",function(r){u(t);let l=d();return h(l.onChangeYesDelete(r))}),a()}if(i&2){let t=d();c("ride",!0)("data",t.data.rideId)}}function Gn(i,e){if(i&1){let t=b();o(0,"app-ride-info-content",7),I(1,"async"),m("changed",function(r){u(t);let l=d();return h(l.onChangeData(r))})("openEditTime",function(r){u(t);let l=d();return h(l.onEditTime(r))})("openEditPrice",function(r){u(t);let l=d();return h(l.onEditPrice(r))}),a()}if(i&2){let t,n=e.$implicit,r=e.$index,l=d();c("index",r)("name",(t=D(1,8,l.stationName$))==null?null:t[r])("segment",n)("segmentPrev",l.data.segments[r-1])("segmentNext",l.data.segments[r+1])("pos",r===0?"start":((l.data==null?null:l.data.segments)||oe(10,jn)).length-1===r?"finish":"")("openEditTimeForm",l.editTime())("openEditPriceForm",l.editPrice())}}var $e=class i{data={rideId:-1,segments:[]};store=g(T);activeRouter=g(ke);showConfirm=f(!1);id=f(this.activeRouter.snapshot.paramMap.get("id"));segments=f([]);stationName$=this.store.select(jt);editTime=f(!1);editPrice=f(!1);ngOnInit(){this.segments.set(this.data.segments)}onChangeData(e){this.segments.update(t=>[...t.slice(0,e.index),{time:e.time,price:e.price},...t.slice(e.index+1)]),this.store.dispatch(lt({data:this.segments(),rideId:this.data.rideId,id:Number(this.id())}))}handleClickDelete(){this.showConfirm.set(!0)}onChangeDelete(e){this.showConfirm.set(e)}onChangeYesDelete(e){e&&this.store.dispatch(mt({roteId:Number(this.id()),rideId:this.data.rideId}))}onEditTime(e){this.editTime.set(e)}onEditPrice(e){this.editPrice.set(e)}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=k({type:i,selectors:[["app-ride-info"]],inputs:{data:"data"},decls:9,vars:3,consts:[[3,"ride","data"],[1,"wrapper"],[1,"title"],[1,"custom-button-wrapper"],["type","button","icon","pi pi-trash",1,"icon",3,"click","text"],[3,"index","name","segment","segmentPrev","segmentNext","pos","openEditTimeForm","openEditPriceForm"],[3,"changed","yesDelete","ride","data"],[3,"changed","openEditTime","openEditPrice","index","name","segment","segmentPrev","segmentNext","pos","openEditTimeForm","openEditPriceForm"]],template:function(t,n){t&1&&(y(0,Zn,1,2,"app-confirm",0),o(1,"div",1)(2,"h3",2),p(3),a(),o(4,"div",3)(5,"p-button",4),m("click",function(){return n.handleClickDelete()}),a()(),o(6,"div"),O(7,Gn,2,11,"app-ride-info-content",5,H),a()()),t&2&&(C(n.showConfirm()?0:-1),s(3),L("Ride ",n.data==null?null:n.data.rideId,""),s(2),c("text",!0),s(2),E(n.data==null?null:n.data.segments))},styles:["*[_ngcontent-%COMP%]{margin:0;padding:0}.wrapper[_ngcontent-%COMP%]{margin-bottom:1rem;background-color:var(--secondary-card-background-color);border-radius:1rem;position:relative}.title[_ngcontent-%COMP%]{padding:1rem}.icon[_ngcontent-%COMP%]{position:absolute;top:0;right:0}"],changeDetection:0})};function Un(i,e){if(i&1&&A(0,"app-message",0),i&2){let t=d();c("error",!0)("text",t.alertText())}}function Hn(i,e){if(i&1&&A(0,"app-message",0),i&2){let t=d();c("error",!0)("text",t.alertTextPrice())}}function Wn(i,e){}function qn(i,e){if(i&1){let t=b();o(0,"p-button",8),m("click",function(){u(t);let r=d();return h(r.handleClickSaveTime())}),a()}i&2&&c("rounded",!0)("raised",!0)("text",!0)}function Qn(i,e){if(i&1){let t=b();o(0,"p-button",9),m("click",function(){u(t);let r=d();return h(r.handleClickEditTime())}),a()}i&2&&c("rounded",!0)("raised",!0)("text",!0)}function Kn(i,e){if(i&1){let t=b();o(0,"input",12),m("change",function(r){u(t);let l=d(2);return h(l.handleChangeTime(r))}),a()}}function Yn(i,e){if(i&1){let t=b();o(0,"input",13),I(1,"date"),m("change",function(r){u(t);let l=d(2);return h(l.handleChangeTime(r))}),a()}if(i&2){let t=d(2);c("value",We(1,1,t.segment==null||t.segment.time==null?null:t.segment.time[0],"yyyy-MM-ddTHH:mm","-0000"))}}function Jn(i,e){if(i&1&&(o(0,"span"),p(1),I(2,"date"),a()),i&2){let t=d(2);s(),L(" ",We(2,1,t.segment==null||t.segment.time==null?null:t.segment.time[0],"yyyy-MM-dd h:mm a","-0000")," ")}}function Xn(i,e){if(i&1&&(o(0,"p"),p(1," Arrival: "),y(2,Kn,1,0,"input",10)(3,Yn,2,5,"input",11)(4,Jn,3,5,"span"),a()),i&2){let t=d();s(2),C(t.create?2:t.editTime()?3:4)}}function er(i,e){if(i&1){let t=b();o(0,"input",16),m("change",function(r){u(t);let l=d(2);return h(l.handleChangeTime(r))}),a()}}function tr(i,e){if(i&1){let t=b();o(0,"input",17),I(1,"date"),m("change",function(r){u(t);let l=d(2);return h(l.handleChangeTime(r))}),a()}if(i&2){let t=d(2);c("value",We(1,1,t.segment==null||t.segment.time==null?null:t.segment.time[1],"yyyy-MM-ddTHH:mm","-0000"))}}function ir(i,e){if(i&1&&(o(0,"span"),p(1),I(2,"date"),a()),i&2){let t=d(2);s(),L(" ",We(2,1,t.segment==null||t.segment.time==null?null:t.segment.time[1],"yyyy-MM-dd h:mm a","-0000")," ")}}function nr(i,e){if(i&1&&(o(0,"p"),p(1," Departure: "),y(2,er,1,0,"input",14)(3,tr,2,5,"input",15)(4,ir,3,5,"span"),a()),i&2){let t=d();s(2),C(t.create?2:t.editTime()?3:4)}}function rr(i,e){}function ar(i,e){if(i&1){let t=b();o(0,"p-button",8),m("click",function(){u(t);let r=d();return h(r.handleClickSavePrice())}),a()}i&2&&c("rounded",!0)("raised",!0)("text",!0)}function or(i,e){if(i&1){let t=b();o(0,"p-button",9),m("click",function(){u(t);let r=d();return h(r.handleClickEditPrice())}),a()}i&2&&c("rounded",!0)("raised",!0)("text",!0)}function sr(i,e){if(i&1){let t=b();o(0,"input",20),m("change",function(r){u(t);let l=d().$index,v=d();return h(v.handleChangePrice(r,l))}),a()}}function lr(i,e){if(i&1){let t=b();o(0,"input",21),m("change",function(r){u(t);let l=d().$index,v=d();return h(v.handleChangePrice(r,l))}),a()}if(i&2){let t=d().$implicit;c("value",t[1])}}function dr(i,e){if(i&1&&(o(0,"span"),p(1),a()),i&2){let t=d().$implicit;s(),L(" ",t[1]," ")}}function cr(i,e){if(i&1&&(o(0,"div",7)(1,"div"),p(2),a(),o(3,"div"),p(4),a(),o(5,"div"),y(6,sr,1,0,"input",18)(7,lr,1,1,"input",19)(8,dr,2,1,"span"),a()()),i&2){let t=e.$implicit,n=d();s(2),ee(t[0]),s(2),ee(" - "),s(2),C(n.create?6:n.editPrice()?7:8)}}var Be=class i{index=-1;name="";pos="";segment={time:[],price:{}};segmentPrev={time:[],price:{}};segmentNext={time:[],price:{}};create=!1;carriagesName=[];openEditTimeForm=!1;openEditPriceForm=!1;changed=new R;changedCreate=new R;openEditTime=new R;openEditPrice=new R;renderer=g(ce);bodyClickListener;price=f([]);editPrice=f(!1);editTime=f(!1);timeSend=f([]);priceSend=f([]);check=f(!1);alert=f(!1);alertPrice=f(!1);alertText=f("");alertTextPrice=f("");checkPrevTime=f(!0);checkNextTime=f(!0);ngOnInit(){this.create?(this.price.set(Object.entries(this.segment||{}).map(([e])=>[e,-1])),this.priceSend.set(Object.entries(this.segment||{}).map(([e])=>[e,-1])),this.timeSend.set(["",""])):(this.price.set(Object.entries(this.segment?.price||{})),this.priceSend.set(Object.entries(this.segment?.price||{})),this.timeSend.set(this.segment?.time||[])),this.bodyClickListener=this.renderer.listen(document.body,"click",e=>{!e.target.closest(".edit_time")&&!e.target.closest(".save_time")&&this.alert.set(!1),!e.target.closest(".edit_price")&&!e.target.closest(".save_price")&&this.alertPrice.set(!1)})}handleClickEditTime(){this.openEditTimeForm?(this.alertText.set("Please close time editing mode."),this.alert.set(!0)):(this.editTime.set(!0),this.openEditTime.emit(!0))}handleClickEditPrice(){this.openEditPriceForm?(this.alertTextPrice.set("Please close price editing mode."),this.alertPrice.set(!0)):(this.editPrice.set(!0),this.openEditPrice.emit(!0))}handleClickSaveTime(){if(this.segmentPrev){let e=[...this.segmentPrev.time,...this.timeSend()].map(n=>new Date(n).getTime()),t=e.slice(1).map((n,r)=>n-e[r]).every(n=>n>0);this.checkPrevTime.set(t)}if(this.segmentNext){let e=[...this.timeSend(),...this.segmentNext.time].map(n=>new Date(n).getTime()),t=e.slice(1).map((n,r)=>n-e[r]).every(n=>n>0);this.checkNextTime.set(t)}if(this.checkNextTime()&&this.checkPrevTime()){this.editTime.set(!1);let e={index:this.index,time:this.timeSend(),price:Object.fromEntries(this.price())};this.changed.emit(e),this.openEditTime.emit(!1)}else this.alertText.set("At each station, the departure time must be greater than the arrival time, and the arrival time at each station must be greater than the departure time from the previous station."),this.alert.set(!0)}handleClickSavePrice(){if(this.priceSend().flat().filter(t=>typeof t=="number").every(t=>t>0)){this.editPrice.set(!1);let t={index:this.index,time:this.timeSend(),price:Object.fromEntries(this.priceSend())};this.changed.emit(t)}else this.alertTextPrice.set("The price must be greater than 0."),this.alertPrice.set(!0)}handleChangeTime(e){let t=e.target;if(t.name==="arrival"&&this.timeSend.update(()=>[`${t.value}:29.906Z`,`${t.value}:30.906Z`]),t.name==="departure"&&this.timeSend.update(()=>[`${t.value}:28.906Z`,`${t.value}:29.906Z`]),this.create){this.pos==="start"&&this.timeSend.set([`${t.value}:28.906Z`,`${t.value}:29.906Z`]),this.pos==="finish"&&this.timeSend.set([`${t.value}:29.906Z`,`${t.value}:30.906Z`]);let n={index:this.index,time:this.timeSend(),price:Object.fromEntries(this.priceSend())};this.changedCreate.emit(n)}}handleChangePrice(e,t){let n=e.target;if(this.priceSend.update(r=>[...r.slice(0,t),[r[t][0],Number(n.value)],...r.slice(t+1)]),this.create){let r={index:this.index,time:this.timeSend(),price:Object.fromEntries(this.priceSend())};this.changedCreate.emit(r)}}ngDoCheck(){Object.values(this.segment?.price||{}).join("")!==this.price().map(e=>e[1]).flat().join("")&&!this.create&&this.price.set(Object.entries(this.segment?.price||{}))}ngOnDestroy(){this.bodyClickListener&&this.bodyClickListener()}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=k({type:i,selectors:[["app-ride-info-content"]],inputs:{index:"index",name:"name",pos:"pos",segment:"segment",segmentPrev:"segmentPrev",segmentNext:"segmentNext",create:"create",carriagesName:"carriagesName",openEditTimeForm:"openEditTimeForm",openEditPriceForm:"openEditPriceForm"},outputs:{changed:"changed",changedCreate:"changedCreate",openEditTime:"openEditTime",openEditPrice:"openEditPrice"},decls:19,vars:7,consts:[[3,"error","text"],[1,"wrapper"],[1,"name"],[1,"time"],["type","button","icon","pi pi-save",1,"edit","save-button",3,"rounded","raised","text"],["type","button","icon","pi pi-pencil",1,"edit","save-button",3,"rounded","raised","text"],[1,"price_content"],[1,"price_box"],["type","button","icon","pi pi-save",1,"edit","save-button",3,"click","rounded","raised","text"],["type","button","icon","pi pi-pencil",1,"edit","save-button",3,"click","rounded","raised","text"],["type","datetime-local","name","arrival","id","arrival"],["type","datetime-local","name","arrival","id","arrival",3,"value"],["type","datetime-local","name","arrival","id","arrival",3,"change"],["type","datetime-local","name","arrival","id","arrival",3,"change","value"],["type","datetime-local","name","departure","id","departure"],["type","datetime-local","name","departure","id","departure",3,"value"],["type","datetime-local","name","departure","id","departure",3,"change"],["type","datetime-local","name","departure","id","departure",3,"change","value"],["type","number","name","price","id","price","min","1",1,"price"],["type","number","name","price","id","price","min","1",1,"price",3,"value"],["type","number","name","price","id","price","min","1",1,"price",3,"change"],["type","number","name","price","id","price","min","1",1,"price",3,"change","value"]],template:function(t,n){t&1&&(y(0,Un,1,2,"app-message",0)(1,Hn,1,2,"app-message",0),o(2,"div",1)(3,"div",2),p(4),a(),o(5,"div",3),y(6,Wn,0,0)(7,qn,1,3,"p-button",4)(8,Qn,1,3,"p-button",5)(9,Xn,5,1,"p")(10,nr,5,1,"p"),a(),o(11,"div",6),y(12,rr,0,0)(13,ar,1,3,"p-button",4)(14,or,1,3,"p-button",5),o(15,"p"),p(16,"Price"),a(),O(17,cr,9,3,"div",7,H),a()()),t&2&&(C(n.alert()?0:-1),s(),C(n.alertPrice()?1:-1),s(3),ee(n.name),s(2),C(n.create?6:n.editTime()?7:8),s(3),C(n.pos!=="start"?9:-1),s(),C(n.pos!=="finish"?10:-1),s(2),C(n.create?12:n.editPrice()?13:14),s(5),E(n.price()))},styles:["*[_ngcontent-%COMP%]{margin:0;padding:0}.wrapper[_ngcontent-%COMP%]{display:grid;width:100%;grid-template-columns:10% 45% 45%;border-top:1px solid var(--primary-background-color)}.name[_ngcontent-%COMP%]{background-color:#fef3c7;width:10rem;padding:1rem}.time[_ngcontent-%COMP%]{flex-shrink:0;padding:3rem;position:relative}.price_content[_ngcontent-%COMP%]{flex-shrink:0;padding-top:1rem;position:relative}.price_box[_ngcontent-%COMP%]{display:flex}.edit[_ngcontent-%COMP%]{position:absolute;top:.5rem;right:1rem;cursor:pointer;transition:all .3s ease-out}.edit[_ngcontent-%COMP%]:hover{transform:var(--primary-icon-transform)}.price[_ngcontent-%COMP%]{width:100%}@media (max-width: 900px){.wrapper[_ngcontent-%COMP%]{grid-template-columns:1fr}.name[_ngcontent-%COMP%]{width:100%}.time[_ngcontent-%COMP%]{padding:1rem}.price_content[_ngcontent-%COMP%]{margin-top:1rem;padding:1rem}}"],changeDetection:0})};function pr(i,e){if(i&1){let t=b();o(0,"app-ride-info-content",8),I(1,"async"),I(2,"async"),m("changedCreate",function(r){u(t);let l=d(2);return h(l.onChangeData(r))}),a()}if(i&2){let t,n,r=d().$index,l=d();c("index",r)("name",(t=D(1,5,l.stationName$))==null?null:t[r])("create",!0)("segment",(n=D(2,7,l.segment$))==null?null:n.price)("pos",r===0?"start":l.data.path.length-2===r?"finish":"")}}function mr(i,e){if(i&1&&y(0,pr,3,9,"app-ride-info-content",7),i&2){let t=e.$index,n=d();C(t!==n.data.path.length-1?0:-1)}}function gr(i,e){i&1&&(o(0,"p",3),p(1," At each station, the departure time must be greater than the arrival time, and the arrival time at each station must be greater than the departure time from the previous station. "),a())}function ur(i,e){i&1&&(o(0,"p",3),p(1,"The price must be greater than 0."),a())}var je=class i{data={id:-1,path:[],carriages:[],schedule:[]};changed=new R;createRide=new R;store=g(T);activeRouter=g(ke);id=f(this.activeRouter.snapshot.paramMap.get("id"));stationName$=this.store.select(jt);carriagesName$=this.store.select(fi);segment$=this.store.select(fi);create=f([]);disabled=f(!0);checkPrice=f(!0);checkTime=f(!0);ngOnInit(){this.create.set(new Array(this.data.path.length-1).fill({time:["",""],price:{asd:0}}))}onChangeData(e){this.create.update(t=>[...t.slice(0,e.index),{time:e.time,price:e.price},...t.slice(e.index+1)]),this.checkData()?this.disabled.set(!1):this.disabled.set(!0)}handleClickCancel(){this.changed.emit(!1)}checkData(){let e=this.create(),t=e.map(v=>[new Date(v.time[0]).getTime(),new Date(v.time[1]).getTime()]).flat(),n=t.slice(1).map((v,Y)=>v-t[Y]).every(v=>v>0);this.checkTime.set(!n);let r=e.map(v=>v.time).flat().every(v=>!!v),l=e.map(v=>Object.values(v.price)).flat().every(v=>v>0);return this.checkPrice.set(!l),r&&l&&n}handleClickCreate(){this.checkData()&&(this.store.dispatch(ct({data:this.create(),id:Number(this.id())})),this.createRide.emit(!1))}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=k({type:i,selectors:[["app-ride-create"]],inputs:{data:"data"},outputs:{changed:"changed",createRide:"createRide"},decls:10,vars:5,consts:[[1,"wrapper"],[1,"content"],[1,"error"],[1,"message"],[1,"button_content"],["type","button","label","Create",3,"click","rounded","disabled"],["label","Cancel","type","button",3,"click","rounded"],[3,"index","name","create","segment","pos"],[3,"changedCreate","index","name","create","segment","pos"]],template:function(t,n){t&1&&(o(0,"div",0)(1,"div",1),O(2,mr,1,1,null,null,H),a(),o(4,"div",2),y(5,gr,2,0,"p",3)(6,ur,2,0,"p",3),a(),o(7,"div",4)(8,"p-button",5),m("click",function(){return n.handleClickCreate()}),a(),o(9,"p-button",6),m("click",function(){return n.handleClickCancel()}),a()()()),t&2&&(s(2),E(n.data.path),s(3),C(n.checkTime()?5:-1),s(),C(n.checkPrice()?6:-1),s(2),c("rounded",!0)("disabled",n.disabled()),s(),c("rounded",!0))},styles:["*[_ngcontent-%COMP%]{margin:0;padding:0}.wrapper[_ngcontent-%COMP%]{margin-bottom:2rem;border-radius:1rem;overflow:hidden;padding-right:1rem;background-color:#f1f5f9}.content[_ngcontent-%COMP%]{margin-bottom:1rem;border-bottom:1px solid var(--color-primary-a10)}.button_content[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:space-around;margin-bottom:1rem}.error[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;padding-left:1rem;padding-right:1rem;align-items:center}.error[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{margin-bottom:.5rem;text-align:center}"],changeDetection:0})};var Ze=class i{data={code:"",name:"",rightSeats:0,leftSeats:0,rows:0};changed=new R;changedDelete=new R;messageService=g(Ot);store=g(T);dataView={rightSeats:0,leftSeats:0,rows:0};active$=new ie;ngOnInit(){this.dataView={rightSeats:this.data.rightSeats,leftSeats:this.data.leftSeats,rows:this.data.rows},this.active$=this.store.select(cn(this.data.name))}change(){this.changed.emit(this.data.code)}ngDoCheck(){this.dataView={rightSeats:this.data.rightSeats,leftSeats:this.data.leftSeats,rows:this.data.rows}}handleClickDelete(){this.active$.pipe(re(1)).subscribe(e=>{e?this.messageService.add({severity:"error",summary:"Error",detail:"This carriage is used in a ride"}):this.data.name&&(this.changedDelete.emit(!1),this.store.dispatch(we({code:{code:this.data.code}})))})}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=k({type:i,selectors:[["app-carriage-info"]],inputs:{data:"data"},outputs:{changed:"changed",changedDelete:"changedDelete"},decls:14,vars:8,consts:[[1,"wrapper"],[1,"block_content"],[1,"content"],[1,"name"],[1,"count"],[1,"block_button"],["type","button","icon","pi pi-pencil",1,"icon",3,"click","text"],["type","button","icon","pi pi-trash",1,"icon",3,"click","text"],[3,"data"]],template:function(t,n){t&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"p",3),p(4),a(),o(5,"p",4),p(6),a(),o(7,"p"),p(8),I(9,"async"),a()(),o(10,"div",5)(11,"p-button",6),m("click",function(){return n.change()}),a(),o(12,"p-button",7),m("click",function(){return n.handleClickDelete()}),a()()(),A(13,"app-carriage-view",8),a()),t&2&&(s(4),ee(n.data.name),s(2),L(" ",(n.data.leftSeats+n.data.rightSeats)*n.data.rows," seats "),s(2),L("(",D(9,6,n.active$)?"Active":"Inactive",")"),s(3),c("text",!0),s(),c("text",!0),s(),c("data",n.dataView))},styles:["*[_ngcontent-%COMP%]{margin:0;padding:0}.wrapper[_ngcontent-%COMP%]{width:100%;padding:.5rem;margin-bottom:1rem;border:1px solid var(--primary-border-color);border-radius:2%}.wrapper[_ngcontent-%COMP%]   .block_content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;margin-bottom:.2rem}.wrapper[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{display:flex}.wrapper[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%]{margin-left:1.5rem;border:1px solid var(secondary-border-color);border-radius:10%;padding-left:.2rem;padding-right:.2rem;margin-right:.4rem}.wrapper[_ngcontent-%COMP%]   .block_button[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.wrapper[_ngcontent-%COMP%]   .icon[_ngcontent-%COMP%]:hover{transform:var(--primary-icon-transform)}"],changeDetection:0})};var pn=(i,e)=>({"grid-template-rows":i,"grid-template-columns":e});function hr(i,e){if(i&1&&(o(0,"div",2),p(1),a()),i&2){let t=e.$implicit;s(),L(" ",t," ")}}function _r(i,e){if(i&1&&(o(0,"div",2),p(1),a()),i&2){let t=e.$implicit;s(),L(" ",t," ")}}function fr(i,e){if(i&1&&(o(0,"div",0)(1,"div",1),O(2,hr,2,1,"div",2,H),a(),o(4,"div",3),O(5,_r,2,1,"div",2,H),a()()),i&2){let t=d();s(),c("ngStyle",be(2,pn,"repeat("+t.data.rightSeats+", 1fr)","repeat("+t.data.rows+", 1fr)")),s(),E(t.result1),s(2),c("ngStyle",be(5,pn,"repeat("+t.data.leftSeats+", 1fr)","repeat("+t.data.rows+", 1fr)")),s(),E(t.result2)}}var Ge=class i{data={rightSeats:0,leftSeats:0,rows:0};changed=new R;result1=[];result2=[];ngOnInit(){this.setData()}setData(){let e=this.data.rightSeats,t=this.data.leftSeats,n=this.data.rows,r=new Array((e+t)*n).fill(0).map((Y,ii)=>ii+1),l=[],v=[];for(let Y=0;Y<r.length/2+1;Y+=1)v.push(r.slice(Y*e+Y*t,Y*e+Y*t+t)),l.push(r.slice(Y*e+Y*t-e,Y*e+Y*t));this.result1=this.updateArr(l,e),this.result2=this.updateArr(v,t)}updateArr(e,t){let n=e.filter(l=>l.length!==0),r=new Array(t).fill(null);for(let l=0;l<n.length;l+=1)for(let v=n[l].length-1;v>=0;v-=1)r[Math.abs(v-t+1)]??=[],r[Math.abs(v-t+1)].push(n[l][v]);return r.flat()}ngDoCheck(){this.setData()}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=k({type:i,selectors:[["app-carriage-view"]],inputs:{data:"data"},outputs:{changed:"changed"},decls:1,vars:1,consts:[[1,"wrapper"],[1,"table","table_top",3,"ngStyle"],[1,"seat"],[1,"table",3,"ngStyle"]],template:function(t,n){t&1&&y(0,fr,7,8,"div",0),t&2&&C(n.data.rows?0:-1)},dependencies:[xi],styles:["*[_ngcontent-%COMP%]{margin:0;padding:0}.wrapper[_ngcontent-%COMP%]{width:100%;border-radius:2%;border:1px solid var(--secondary-border-color);overflow:auto;padding:.8rem}.table[_ngcontent-%COMP%]{display:grid;row-gap:.3rem;column-gap:.2rem;justify-items:center}.table_top[_ngcontent-%COMP%]{margin-bottom:3rem}.seat[_ngcontent-%COMP%]{width:3rem;height:3rem;background-color:var(--secondary-border-color);border-radius:20%;display:flex;justify-content:center;align-items:center}"],changeDetection:0})};var fl=gi([mi({transform:"{{transform}}",opacity:0}),pi("{{transition}}")]),Cl=gi([pi("{{transition}}",mi({transform:"{{transform}}",opacity:0}))]);var mn=(()=>{class i{static \u0275fac=function(n){return new(n||i)};static \u0275mod=me({type:i});static \u0275inj=pe({imports:[Mt,Ti,hi,Pi,hi]})}return i})();var Ht=class i{http=g(ue);storage=g(he);getStations(){return this.http.get("/api/station").pipe(B(2),x(e=>_(`Bad Promise: ${e}`)))}deleteStations(e){return this.http.delete(`/api/station/${e}`,{headers:{Authorization:`Bearer ${this.storage.getItem("token")}`}}).pipe(B(2),x(t=>_(`Bad Promise: ${t}`)))}createStation(e){return this.http.post("/api/station",{city:e.city,latitude:e.latitude,longitude:e.longitude,relations:[...e.relations]},{headers:{Authorization:`Bearer ${this.storage.getItem("token")}`}}).pipe(B(2),x(t=>_(`Bad Promise: ${t}`)))}static \u0275fac=function(t){return new(t||i)};static \u0275prov=ne({token:i,factory:i.\u0275fac,providedIn:"root"})};var Wt=class i{http=g(ue);storage=g(he);getRoutes(){return this.http.get("/api/route").pipe(B(2),x(e=>_(`Bad Promise: ${e}`)))}deleteRouter(e){return this.http.delete(`/api/route/${e}`,{headers:{Authorization:`Bearer ${this.storage.getItem("token")}`}}).pipe(B(2),x(t=>_(`Bad Promise: ${t}`)))}createRouter(e){return this.http.post("/api/route",{path:[...e.path],carriages:[...e.carriages]},{headers:{Authorization:`Bearer ${this.storage.getItem("token")}`}}).pipe(B(2),x(t=>_(`Bad Promise: ${t}`)))}updateRouter(e){return this.http.put(`/api/route/${e.id}`,{path:[...e.path],carriages:[...e.carriages]},{headers:{Authorization:`Bearer ${this.storage.getItem("token")}`}}).pipe(B(2),x(t=>_(`Bad Promise: ${t}`)))}static \u0275fac=function(t){return new(t||i)};static \u0275prov=ne({token:i,factory:i.\u0275fac,providedIn:"root"})};var qt=class i{http=g(ue);storage=g(he);getCarriages(){return this.http.get("/api/carriage",{headers:{Authorization:`Bearer ${this.storage.getItem("token")}`}}).pipe(B(2),x(e=>_(`Bad Promise: ${e}`)))}updateCarriage(e,t){return this.http.put(`/api/carriage/${e}`,t,{headers:{Authorization:`Bearer ${this.storage.getItem("token")}`}}).pipe(B(2),x(n=>_(`Bad Promise: ${n}`)))}createCarriage(e){return this.http.post("/api/carriage",e,{headers:{Authorization:`Bearer ${this.storage.getItem("token")}`}}).pipe(B(2),x(t=>_(`Bad Promise: ${t}`)))}deleteCarriage(e){return this.http.delete(`/api/carriage/${e}`,{headers:{Authorization:`Bearer ${this.storage.getItem("token")}`}}).pipe(B(2),x(t=>_(`Bad Promise: ${t}`)))}static \u0275fac=function(t){return new(t||i)};static \u0275prov=ne({token:i,factory:i.\u0275fac,providedIn:"root"})};var Qt=class i{http=g(ue);storage=g(he);getRide(e){return this.http.get(`/api/route/${e}`,{headers:{Authorization:`Bearer ${this.storage.getItem("token")}`}}).pipe(B(2),x(t=>_(`Bad Promise: ${t}`)))}updateRide(e,t,n){return this.http.put(`/api/route/${e}/ride/${t}`,{segments:n},{headers:{Authorization:`Bearer ${this.storage.getItem("token")}`}}).pipe(B(2),x(r=>_(`Bad Promise: ${r}`)))}createRide(e,t){return this.http.post(`/api/route/${e}/ride`,{segments:t},{headers:{Authorization:`Bearer ${this.storage.getItem("token")}`}}).pipe(B(2),x(n=>_(`Bad Promise: ${n}`)))}deleteRide(e,t){return this.http.delete(`/api/route/${e}/ride/${t}`,{headers:{Authorization:`Bearer ${this.storage.getItem("token")}`}}).pipe(B(2),x(n=>_(`Bad Promise: ${n}`)))}static \u0275fac=function(t){return new(t||i)};static \u0275prov=ne({token:i,factory:i.\u0275fac,providedIn:"root"})};var Kt=class i{constructor(e,t,n,r){this.stationService=e;this.routeService=t;this.carriageService=n;this.rideService=r}actions$=g(ji);getAllStations$=G(()=>this.actions$.pipe(U(Ie,st),j(()=>this.stationService.getStations().pipe(V(e=>Le({stations:[...e]})),x(()=>_(K())),Q(()=>_($({isLoading:!1})))))));getRide$=G(()=>this.actions$.pipe(U(ot),j(e=>this.rideService.getRide(e.id).pipe(V(t=>st({data:t})),x(()=>_(K())),Q(()=>_($({isLoading:!1})))))));getAllRoutes$=G(()=>this.actions$.pipe(U(_i,Le,Pe),j(()=>this.routeService.getRoutes().pipe(V(e=>Pt({routes:[...e]})),x(()=>_(K())),Q(()=>_($({isLoading:!1})))))));getAllCarriages$=G(()=>this.actions$.pipe(U(Pe,Le),j(()=>this.carriageService.getCarriages().pipe(V(e=>Xe({carriages:[...e]})),x(()=>_(K())),Q(()=>_($({isLoading:!1})))))));addStation$=G(()=>this.actions$.pipe(U(Ke),j(e=>this.stationService.createStation(e.station).pipe(V(t=>Ye({station:e.station,id:t})),x(()=>_(K())),Q(()=>_($({isLoading:!1})))))));addCarriages$=G(()=>this.actions$.pipe(U(ut),j(e=>this.carriageService.createCarriage(e.carriages).pipe(V(t=>ht({carriages:e.carriages,code:t})),x(()=>_(K())),Q(()=>_($({isLoading:!1})))))));deleteStation$=G(()=>this.actions$.pipe(U(Se),j(e=>this.stationService.deleteStations(e.id).pipe(V(()=>Je({id:e.id})),x(()=>_(K())),Q(()=>_($({isLoading:!1})))))));deleteCarriages$=G(()=>this.actions$.pipe(U(we),j(e=>this.carriageService.deleteCarriage(e.code.code).pipe(V(()=>Ct({code:e.code})),x(()=>_(K())),Q(()=>_($({isLoading:!1})))))));deleteRouter$=G(()=>this.actions$.pipe(U(et),j(e=>this.routeService.deleteRouter(e.id).pipe(V(()=>tt({id:e.id})),x(()=>_(K())),Q(()=>_($({isLoading:!1})))))));deleteRide$=G(()=>this.actions$.pipe(U(mt),j(e=>this.rideService.deleteRide(e.roteId,e.rideId).pipe(V(()=>gt({rideId:e.rideId})),x(()=>_(K())),Q(()=>_($({isLoading:!1})))))));updateRouter$=G(()=>this.actions$.pipe(U(it),j(e=>this.routeService.updateRouter(e.data).pipe(V(()=>nt({data:e.data})),x(()=>_(K())),Q(()=>_($({isLoading:!1})))))));updateCarriages$=G(()=>this.actions$.pipe(U(_t),j(e=>this.carriageService.updateCarriage(e.code.code,e.data).pipe(V(t=>ft({data:e.data,code:t})),x(()=>_(K())),Q(()=>_($({isLoading:!1})))))));createRouter$=G(()=>this.actions$.pipe(U(rt),j(e=>this.routeService.createRouter(e.data).pipe(V(t=>{let n={id:t.id,carriages:e.data.carriages,path:e.data.path};return at({data:n})}),x(()=>_(K())),Q(()=>_($({isLoading:!1})))))));createRide$=G(()=>this.actions$.pipe(U(ct),j(e=>this.rideService.createRide(e.id,e.data).pipe(V(t=>pt({data:e.data,rideId:t.id})),x(()=>_(K())),Q(()=>_($({isLoading:!1})))))));updateRide$=G(()=>this.actions$.pipe(U(lt),j(e=>this.rideService.updateRide(e.id,e.rideId,e.data).pipe(V(()=>dt({data:e.data,rideId:e.rideId})),x(()=>_(K())),Q(()=>_($({isLoading:!1})))))));startLoading$=G(()=>this.actions$.pipe(U(Ie,Ke,_i,Se,Pe,et,it,rt,ot,lt,ct,mt,ut,_t,we),V(()=>$({isLoading:!0}))));finishLoading$=G(()=>this.actions$.pipe(U(Ye,Je,Xe,tt,nt,at,dt,pt,gt,ht,ft,Ct),V(()=>$({isLoading:!1}))));static \u0275fac=function(t){return new(t||i)(Me(Ht),Me(Wt),Me(qt),Me(Qt))};static \u0275prov=ne({token:i,factory:i.\u0275fac})};var Ir={isLoading:!1,isAlert:!1,stations:[],routes:[],showData:[],carriages:[],ride:{id:0,path:[],carriages:[],schedule:[]}},gn=Bi(Ir,F($,(i,{isLoading:e})=>w(S({},i),{isLoading:e})),F(fe,(i,{isAlert:e})=>w(S({},i),{isAlert:e})),F(Le,(i,{stations:e})=>w(S({},i),{stations:[...e]})),F(Ye,(i,{station:e,id:t})=>w(S({},i),{stations:[...i.stations,{city:e.city,id:t.id,latitude:e.latitude,longitude:e.longitude,connectedTo:e.relations.map(n=>({id:n}))}]})),F(Je,(i,{id:e})=>w(S({},i),{isAlert:!1,stations:[i.stations.slice(0,i.stations.findIndex(t=>t.id===e)),i.stations.slice(i.stations.findIndex(t=>t.id===e)+1)].flat()})),F(Se,i=>w(S({},i),{isAlert:!1})),F(tt,(i,{id:e})=>w(S({},i),{routes:[i.routes.filter(t=>t.id!==e)].flat()})),F(Pt,(i,{routes:e})=>w(S({},i),{routes:[...e]})),F(Fe,(i,{id:e,valueForm:t})=>w(S({},i),{showData:e===0?[[...i.stations]]:[...i.showData,i.stations.find(n=>n.id===Number(t[e-1])).connectedTo.map(n=>n.id).map(n=>i.stations.find(r=>r.id===n)).filter(n=>!t.slice(0,e)?.includes(String(n?.id))||n?.id===Number(t[e]))]})),F(Lt,(i,{id:e})=>w(S({},i),{showData:i.showData.slice(0,e+1)})),F(Ft,i=>w(S({},i),{showData:[i.showData[0]]})),F(Xe,(i,{carriages:e})=>w(S({},i),{carriages:[...e]})),F(nt,(i,{data:e})=>w(S({},i),{routes:[...i.routes.slice(0,i.routes.findIndex(t=>t.id===e.id)),e,...i.routes.slice(i.routes.findIndex(t=>t.id===e.id)+1)]})),F(at,(i,{data:e})=>w(S({},i),{routes:[...i.routes,e]})),F(st,(i,{data:e})=>w(S({},i),{ride:e})),F(dt,(i,{data:e,rideId:t})=>w(S({},i),{ride:w(S({},i.ride),{schedule:i.ride.schedule.map(n=>n.rideId===t?{rideId:t,segments:e}:n)})})),F(gt,(i,{rideId:e})=>w(S({},i),{ride:w(S({},i.ride),{schedule:i.ride.schedule.filter(t=>t.rideId!==e)})})),F(pt,(i,{data:e,rideId:t})=>w(S({},i),{ride:w(S({},i.ride),{schedule:[...i.ride.schedule,{rideId:t,segments:e}]})})),F(ht,(i,{carriages:e,code:t})=>w(S({},i),{carriages:[...i.carriages,{code:t.code,leftSeats:e.leftSeats,name:e.name,rightSeats:e.rightSeats,rows:e.rows}]})),F(ft,(i,{data:e,code:t})=>w(S({},i),{carriages:[...i.carriages.map(n=>n.code===t.code?{code:t.code,leftSeats:e.leftSeats,name:e.name,rightSeats:e.rightSeats,rows:e.rows}:n)]})),F(we,i=>w(S({},i),{isAlert:!1})),F(Ct,(i,{code:e})=>w(S({},i),{carriages:[...i.carriages.filter(t=>t.code!==e.code)]})));var Sr=(i,e)=>e.code,wr=i=>({disabled:i});function Mr(i,e){i&1&&A(0,"app-loader")}function xr(i,e){i&1&&A(0,"app-message",0),i&2&&c("error",!0)("text","Cannot delete carriage with active rides")}function kr(i,e){if(i&1){let t=b();o(0,"form",7),m("submit",function(){u(t);let r=d();return h(r.handleSubmit())}),o(1,"div",8)(2,"label",9),p(3,"Name"),a(),A(4,"input",10),a(),o(5,"div",8)(6,"label",11),p(7,"Rows"),a(),o(8,"input",12),m("input",function(){u(t);let r=d();return h(r.changeInput())}),a()(),o(9,"div",8)(10,"label",13),p(11,"Left Seats"),a(),o(12,"input",14),m("input",function(){u(t);let r=d();return h(r.changeInput())}),a()(),o(13,"div",8)(14,"label",15),p(15,"Right Seats"),a(),o(16,"input",16),m("input",function(){u(t);let r=d();return h(r.changeInput())}),a()(),o(17,"div",17),A(18,"app-carriage-view",6),a(),o(19,"p-button",18),m("click",function(){u(t);let r=d();return h(r.handleSubmit())}),a()()}if(i&2){let t=d();c("formGroup",t.form),s(4),c("value",t.nameUser),s(4),c("value",t.rowsUser),s(4),c("value",t.leftSeatsUser),s(4),c("value",t.rightSeatsUser),s(2),c("data",t.viewCreate),s(),c("ngClass",He(9,wr,!t.form.valid))("rounded",!0)("label",t.updateCarriage()?"Update":"Save")}}function Ar(i,e){if(i&1){let t=b();o(0,"app-carriage-info",19),m("changed",function(r){u(t);let l=d();return h(l.onChanged(r))})("changedDelete",function(r){u(t);let l=d();return h(l.onChangedDelete(r))}),a()}if(i&2){let t=e.$implicit;c("data",t)}}var Yt=class i{store=g(T);formBuilder=g(Te);data$=this.store.select(Bt);loading$=this.store.select(Ce);show=f(!1);code=f("");updateCarriage=f(!1);update=!1;form=this.formBuilder.group({name:["",{validators:[J.required,this.uniqNameValid.bind(this)]}],rows:["",{validators:[J.required]}],leftSeats:["",{validators:[J.required]}],rightSeats:["",{validators:[J.required]}]});nameUser="";rowsUser="";leftSeatsUser="";rightSeatsUser="";viewCreate={rows:Number(this.rowsUser),leftSeats:Number(this.leftSeatsUser),rightSeats:Number(this.rightSeatsUser)};alert$=this.store.select(Nt);renderer=g(ce);bodyClickListener;uniqNameValid(e){let t=!1;return this.store.select(dn(e.value.trim())).pipe(re(1)).subscribe(n=>{t=n}),this.updateCarriage()||!t?null:{uniqNameValid:!0}}handleClickCreate(){this.show()&&this.clearForm(),this.show.update(e=>!e),this.updateCarriage.set(!1)}clearForm(){this.form.reset({name:"",leftSeats:"",rightSeats:"",rows:""}),this.rowsUser="",this.nameUser="",this.leftSeatsUser="",this.rightSeatsUser="",this.setViewCreateUpdate(),this.setViewCreate()}setViewCreate(){this.viewCreate={rows:Number(this.form.value.rows),leftSeats:Number(this.form.value.leftSeats),rightSeats:Number(this.form.value.rightSeats)}}setViewCreateUpdate(){this.form.controls.rows.setValue(this.rowsUser),this.form.controls.leftSeats.setValue(this.leftSeatsUser),this.form.controls.rightSeats.setValue(this.rightSeatsUser)}changeInput(){this.setViewCreate()}handleSubmit(){if(this.form.valid){let e={leftSeats:Number(this.form.value.leftSeats),name:this.form.value.name||"",rightSeats:Number(this.form.value.rightSeats),rows:Number(this.form.value.rows)};this.updateCarriage()?this.store.dispatch(_t({data:e,code:{code:this.code()}})):this.store.dispatch(ut({carriages:e})),this.handleClickCreate()}}onChangedDelete(e){this.show()&&this.clearForm(),this.show.set(e),this.updateCarriage.set(!1)}onChanged(e){this.code.set(e),this.updateCarriage.set(!0),this.show.set(!0),this.data$.pipe(re(1)).subscribe(t=>{let n=t.find(r=>r.code===e);this.rowsUser=String(n?.rows),this.nameUser=String(n?.name),this.form.controls.name.setValue(this.nameUser),this.leftSeatsUser=String(n?.leftSeats),this.rightSeatsUser=String(n?.rightSeats),this.setViewCreateUpdate(),this.setViewCreate()})}ngOnInit(){this.store.dispatch(Pe()),this.bodyClickListener=this.renderer.listen(document.body,"click",e=>{e.target.classList.contains("trash")||this.store.dispatch(fe({isAlert:!1}))})}ngOnDestroy(){this.bodyClickListener&&this.bodyClickListener()}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=k({type:i,selectors:[["app-carriages"]],decls:13,vars:11,consts:[[3,"error","text"],[1,"wrapper"],[1,"carries"],[1,"button"],["size","small","type","button",3,"click","label","rounded"],[1,"form",3,"formGroup"],[3,"data"],[1,"form",3,"submit","formGroup"],[1,"form__line"],["for","name",1,"line__label"],["type","text","id","name","formControlName","name",1,"line__input",3,"value"],["for","rows",1,"line__label"],["type","number","id","rows","formControlName","rows","min","1",1,"line__input",3,"input","value"],["for","leftSeats",1,"line__label"],["type","number","id","leftSeats","formControlName","leftSeats","min","1",1,"line__input",3,"input","value"],["for","rightSeats",1,"line__label"],["type","number","id","rightSeats","formControlName","rightSeats","min","1",1,"line__input",3,"input","value"],[1,"view"],["type","button",1,"button",3,"click","ngClass","rounded","label"],[3,"changed","changedDelete","data"]],template:function(t,n){t&1&&(y(0,Mr,1,0,"app-loader"),I(1,"async"),y(2,xr,1,2,"app-message",0),I(3,"async"),o(4,"div",1),A(5,"app-navigation"),o(6,"div",2)(7,"div",3)(8,"p-button",4),m("click",function(){return n.handleClickCreate()}),a()(),y(9,kr,20,11,"form",5),O(10,Ar,1,1,"app-carriage-info",6,Sr),I(12,"async"),a()()),t&2&&(C(D(1,5,n.loading$)?0:-1),s(2),C(D(3,7,n.alert$)?2:-1),s(6),c("label",n.show()?"Cancel":"Create")("rounded",!0),s(),C(n.show()?9:-1),s(),E(D(12,9,n.data$)))},dependencies:[wt,Re,xt,kt,De,ze,Oi,Oe,Ee,N,_e,se,de,Ze,Ge,W],styles:["*[_ngcontent-%COMP%]{margin:0;padding:0}.wrapper[_ngcontent-%COMP%]{display:flex;justify-content:space-between;width:100%;max-width:100rem;overflow:hidden;background-color:var(--primary-card-background-color);margin-left:auto;margin-right:auto}.carries[_ngcontent-%COMP%]{width:calc(100% - 90px);padding:1rem}.button[_ngcontent-%COMP%]{margin-bottom:.5rem}.form[_ngcontent-%COMP%]{display:flex;flex-direction:column}.form__line[_ngcontent-%COMP%]{margin-bottom:.5rem;display:flex;justify-content:space-between;width:20rem}.line__input[_ngcontent-%COMP%]{width:10rem;padding:.4rem;border-radius:.5rem}.view[_ngcontent-%COMP%]{margin-bottom:.5rem}"],changeDetection:0})};var Dr=(i,e)=>e.id;function zr(i,e){i&1&&A(0,"app-loader")}function Rr(i,e){i&1&&A(0,"app-message",0),i&2&&c("error",!0)("text","Please cancel the form")}function Or(i,e){if(i&1){let t=b();o(0,"div",3)(1,"p-button",5),m("click",function(){u(t);let r=d();return h(r.handleClickCreate())}),a()()}}function Er(i,e){if(i&1){let t=b();o(0,"app-form-router",6),m("changed",function(r){u(t);let l=d();return h(l.onCancelEdit(r))}),a()}if(i&2){let t=d();c("data",t.edit$())}}function Tr(i,e){if(i&1){let t=b();o(0,"app-router-info",7),m("changed",function(r){u(t);let l=d();return h(l.onClickEdit(r))})("changedDelete",function(r){u(t);let l=d();return h(l.onClickDelete(r))}),a()}if(i&2){let t=e.$implicit;c("data",t)}}var Jt=class i{store=g(T);renderer=g(ce);bodyClickListener;showCreate$=f(!1);showAlert$=f(!1);edit$=f({data:{id:-1,carriages:[],path:[]},update:!1,checkUpdate:!1});routes$=this.store.select(Xi);loading$=this.store.select(Ce);ngOnInit(){this.store.dispatch(Ie()),this.bodyClickListener=this.renderer.listen(document.body,"click",e=>{e.target.closest(".button_edit")||this.showAlert$.set(!1)})}handleClickCreate(){this.showCreate$.set(!0)}onClickEdit(e){this.showCreate$()?this.showAlert$.set(!0):(this.edit$.set({data:e,update:!0,checkUpdate:!0}),this.showCreate$.set(!0))}onClickDelete(e){this.showCreate$.set(!e)}onCancelEdit(e){this.showCreate$.set(e)}ngOnDestroy(){this.bodyClickListener&&this.bodyClickListener()}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=k({type:i,selectors:[["app-routes"]],decls:11,vars:7,consts:[[3,"error","text"],[1,"wrapper"],[1,"router_content"],[1,"button"],[3,"data"],["icon","pi pi-plus","type","button",3,"click"],[3,"changed","data"],[3,"changed","changedDelete","data"]],template:function(t,n){t&1&&(y(0,zr,1,0,"app-loader"),I(1,"async"),y(2,Rr,1,2,"app-message",0),o(3,"div",1),A(4,"app-navigation"),o(5,"div",2),y(6,Or,2,0,"div",3)(7,Er,1,1,"app-form-router",4),O(8,Tr,1,1,"app-router-info",4,Dr),I(10,"async"),a()()),t&2&&(C(D(1,3,n.loading$)?0:-1),s(2),C(n.showAlert$()?2:-1),s(4),C(n.showCreate$()?7:6),s(2),E(D(10,5,n.routes$)))},dependencies:[N,_e,se,de,Gt,Ne,W],styles:["*[_ngcontent-%COMP%]{margin:0;padding:0}.wrapper[_ngcontent-%COMP%]{display:flex;justify-content:space-between;width:100%;max-width:100rem;background-color:var(--primary-card-background-color);margin-left:auto;margin-right:auto}.router_content[_ngcontent-%COMP%]{width:100%;padding:1rem;display:flex;flex-direction:column;align-items:stretch}.button[_ngcontent-%COMP%]{margin-bottom:1rem}"],changeDetection:0})};var un=(i,e)=>({lat:i,lng:e});function Pr(i,e){i&1&&A(0,"app-message",2),i&2&&c("error",!0)("text","Cannot delete station with active rides")}function Lr(i,e){i&1&&A(0,"app-loader")}function Fr(i,e){if(i&1&&A(0,"map-advanced-marker",8,0),i&2){let t=d(2);c("position",be(1,un,t.userMark().lat,t.userMark().lng))}}function Vr(i,e){if(i&1){let t=b();o(0,"map-advanced-marker",12,0),m("mapClick",function(){u(t);let r=ye(1),l=ye(3);return h(l.open(r))}),a(),o(2,"map-info-window",null,1),p(4),a()}if(i&2){let t=e.$implicit;c("position",be(3,un,t.lat,t.lng))("title",t.city),s(4),ee(t.city)}}function Nr(i,e){if(i&1&&A(0,"app-station-info",11),i&2){let t=e.$implicit;c("data",t)}}function $r(i,e){if(i&1){let t=b();o(0,"div",3),A(1,"app-navigation"),o(2,"div",4)(3,"div",5)(4,"div",6)(5,"google-map",7),m("mapClick",function(r){u(t);let l=d();return h(l.moveMap(r))}),y(6,Fr,2,4,"map-advanced-marker",8),O(7,Vr,5,6,null,null,H),I(9,"async"),a()(),o(10,"app-form-station",9),I(11,"async"),m("changed",function(r){u(t);let l=d();return h(l.onChanged(r))}),a()(),o(12,"div",10),O(13,Nr,1,1,"app-station-info",11,Si),I(15,"async"),a()()()}if(i&2){let t=d();s(5),c("options",t.options),s(),C(t.userMark().show?6:-1),s(),E(D(9,4,t.nzLocations$)),s(3),c("userMarkInput",t.userMark())("dataInput",D(11,6,t.data$)),s(3),E(D(15,8,t.allStation$))}}var Xt=class i{store=g(T);renderer=g(ce);bodyClickListener;options={mapId:"faab40f8d46a15b8",zoom:4};nzLocations$=this.store.select(nn);infoWindow;data$=this.store.select(tn);allStation$=this.store.select($t);loading$=this.store.select(Ce);alert$=this.store.select(Nt);userMark=f({show:!1,lat:0,lng:0,city:""});ngOnInit(){this.store.dispatch(Ie()),this.bodyClickListener=this.renderer.listen(document.body,"click",e=>{e.target.classList.contains("trash")||this.store.dispatch(fe({isAlert:!1}))})}ngOnDestroy(){this.bodyClickListener&&this.bodyClickListener()}onMarkerClick(e){this.infoWindow.openAdvancedMarkerElement(e.advancedMarker,e.advancedMarker.title)}moveMap(e){this.userMark.update(t=>w(S({},t),{show:!0,lat:e.latLng.lat(),lng:e.latLng.lng()}))}onChanged(e){this.userMark.set(S({},e))}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=k({type:i,selectors:[["app-stations"]],viewQuery:function(t,n){if(t&1&&wi(Tt,5),t&2){let r;It(r=St())&&(n.infoWindow=r.first)}},decls:5,vars:6,consts:[["marker","mapAdvancedMarker"],["window","mapInfoWindow"],[3,"error","text"],[1,"wrapper"],[1,"station_content"],[1,"add_station"],[1,"map"],["width","100%","height","100%",3,"mapClick","options"],[3,"position"],[3,"changed","userMarkInput","dataInput"],[1,"stations"],[3,"data"],[3,"mapClick","position","title"]],template:function(t,n){t&1&&(y(0,Pr,1,2,"app-message",2),I(1,"async"),y(2,Lr,1,0,"app-loader"),I(3,"async"),y(4,$r,16,10,"div",3)),t&2&&(C(D(1,2,n.alert$)?0:-1),s(2),C(D(3,4,n.loading$)?2:4))},dependencies:[Et,Tt,Wi,_e,se,Vt,Zt,de,W],styles:["*[_ngcontent-%COMP%]{margin:0;padding:0}.wrapper[_ngcontent-%COMP%]{display:flex;justify-content:space-between;width:100%;max-width:100rem;background-color:var(--primary-card-background-color);margin-left:auto;margin-right:auto}.station_content[_ngcontent-%COMP%]{width:100%;padding:1rem}.map[_ngcontent-%COMP%]{width:100%;height:30rem;margin-right:1rem}.add_station[_ngcontent-%COMP%]{display:flex;margin-bottom:1rem}@media (max-width: 768px){.add_station[_ngcontent-%COMP%]{flex-direction:column}.map[_ngcontent-%COMP%]{width:100%;height:20rem;margin-right:0}}"],changeDetection:0})};var Br=(i,e)=>e.rideId,jr=()=>[];function Zr(i,e){i&1&&A(0,"app-loader")}function Gr(i,e){if(i&1){let t=b();o(0,"p-button",7),m("click",function(){u(t);let r=d();return h(r.handleClickCreate())}),a()}}function Ur(i,e){if(i&1){let t=b();o(0,"app-ride-create",8),I(1,"async"),m("changed",function(r){u(t);let l=d();return h(l.onChangeCancel(r))})("createRide",function(r){u(t);let l=d();return h(l.onChangeCreate(r))}),a()}if(i&2){let t=d();c("data",D(1,1,t.data$))}}function Hr(i,e){if(i&1&&A(0,"app-ride-info",6),i&2){let t=e.$implicit;c("data",t)}}var ei=class i{store=g(T);activeRouter=g(ke);router=g(Ae);id=f(this.activeRouter.snapshot.paramMap.get("id"));loading$=this.store.select(Ce);data$=this.store.select(ln);showCreate$=f(!1);handleClickBack(){this.router.navigate(["admin","routes"])}ngOnInit(){this.store.dispatch(ot({id:Number(this.id())}))}handleClickCreate(){this.showCreate$.set(!0)}onChangeCancel(e){this.showCreate$.set(e)}onChangeCreate(e){this.showCreate$.set(e)}static \u0275fac=function(t){return new(t||i)};static \u0275cmp=k({type:i,selectors:[["app-rides"]],decls:15,vars:10,consts:[[1,"wrapper"],[1,"rides_content"],[1,"title"],[1,"button_content"],["type","button","icon","pi pi-arrow-left",3,"click","rounded"],["icon","pi pi-plus","type","button"],[3,"data"],["icon","pi pi-plus","type","button",3,"click"],[3,"changed","createRide","data"]],template:function(t,n){if(t&1&&(y(0,Zr,1,0,"app-loader"),I(1,"async"),o(2,"div",0),A(3,"app-navigation"),o(4,"div",1)(5,"h2",2),p(6),a(),o(7,"div",3)(8,"p-button",4),m("click",function(){return n.handleClickBack()}),a(),y(9,Gr,1,0,"p-button",5),a(),y(10,Ur,2,3,"app-ride-create",6),o(11,"div"),O(12,Hr,1,1,"app-ride-info",6,Br),I(14,"async"),a()()()),t&2){let r;C(D(1,5,n.loading$)?0:-1),s(6),L("Route ",n.id(),""),s(2),c("rounded",!0),s(),C(n.showCreate$()?-1:9),s(),C(n.showCreate$()?10:-1),s(2),E(((r=D(14,7,n.data$))==null?null:r.schedule)||oe(9,jr))}},dependencies:[N,_e,se,$e,je,W],styles:["*[_ngcontent-%COMP%]{margin:0;padding:0}.wrapper[_ngcontent-%COMP%]{display:flex;justify-content:space-between;width:100%;max-width:100rem;background-color:var(--primary-card-background-color);margin-left:auto;margin-right:auto}.rides_content[_ngcontent-%COMP%]{width:100%;padding:1rem;display:flex;flex-direction:column}.title[_ngcontent-%COMP%]{text-align:center}.button_content[_ngcontent-%COMP%]{display:flex;justify-content:space-between;width:100%;margin-bottom:1rem;padding-top:1rem}"],changeDetection:0})};var Wr=[{path:"",redirectTo:"stations",pathMatch:"full"},{path:"stations",title:"StationsPage",component:Xt},{path:"carriages",title:"CarriagesPage",component:Yt},{path:"routes",title:"RoutesPage",component:Jt},{path:"routes/:id",title:"RidePage",component:ei}],ti=class i{static \u0275fac=function(t){return new(t||i)};static \u0275mod=me({type:i});static \u0275inj=pe({imports:[ui.forChild(Wr),ui]})};var hn=class i{static \u0275fac=function(t){return new(t||i)};static \u0275mod=me({type:i});static \u0275inj=pe({imports:[Mt,ti,qi,Ei,$i.forFeature("admin",gn),Zi.forFeature([Kt]),mn,N,Fi,Vi,Li]})};xe(Ne,function(){return[N,vt]},function(){return[W]});xe($e,function(){return[N,vt,Be]},function(){return[W]});xe(Be,function(){return[N,de]},function(){return[ki]});xe(je,function(){return[N,Be]},function(){return[W]});xe(Ze,function(){return[N,Ge]},function(){return[W]});export{hn as AdminModule};
